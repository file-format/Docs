{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"WMV файлов формат",
  "description":"Научете за WMV файловия формат и API, които могат да създават и отварят WMV файлове.",
  "linktitle" : "WMV",
  "menu" : {
    "docs" : {
      "parent" : "video"
}
},
  "lastmod" : "2019-09-16"
}

## Какво е WMV файл?

Advanced Systems Format (ASF) е цифров мултимедиен контейнер, предназначен основно за съхраняване и предаване на медийни потоци. Microsoft Windows Media Video (WMV) е компресираният видео формат, а Microsoft Windows Media Audio (WMA) е компресираният аудио формат заедно с допълнителни метаданни в ASF контейнера, разработен от Microsoft. След като WMV или WMA файловете са кодирани с Windows Media Video и Windows Media Audio кодеци, те се представят с разширение .asf. WMV компресира големи файлове за по-добра скорост на предаване през мрежа, като същевременно запазва качеството на видеото. WMV е специално проектиран да работи на всички устройства с Windows. След стандартизацията от Обществото на киноинженерите и телевизионните инженери (SMPTE), WMV сега се счита за отворен стандартен формат.

## История ##

С помощта на собствени кодеци на Microsoft през 1999 г. беше разработен нов компресиран видео формат, известен като WMV7, който беше базиран на MPEG-4, част 2. Подобрения бяха добавени в още две версии, т.е. WMV8 и 9. Microsoft представи 9^^та^^ версия на WMV към SMPTE за стандартизация през 2003 г., който в крайна сметка беше стандартизиран през 2006 г. като SMPTE 421M, известен също като VC-1. Идеята зад WMV беше да се разработи медиен формат, който може да се поддържа от целия поддържан от Microsoft хардуер и софтуер. Освен това друга основна цел беше да се предават видео потоци през интернет при оптимален сценарий. След стандартизацията от SMPTE, WMV също стана видео формат за Blu-ray дискове.

## Спецификации на файловия формат

### Контейнер

Обикновено WMV е опакован в ASF контейнер, но освен това Matroska или AVI контейнерът може също да го поддържа с разширения съответно .mkv и .avi.

### Windows Media Video 9

Въпреки че има различни аудио и видео кодеци, налични в серията Windows Media Video 9 за създаване и възпроизвеждане на цифрови медии, кодекът WMV-9 е най-новият и най-добрият видео кодек, тъй като може да постигне оптимална компресия от много ниски битрейтове, т.е. 160 x 120 при 10 Kbps до 1920 x 1080 при 4-8 Mbps за различни HD видеоклипове.

### Структура на кодека

WMV-9 има 8-битов 4:2:0 вътрешен цветен формат. Подобно на всички други популярни стандарти за компресиране на видео MPEG-1 и H.261, WMV-9 използва компенсация на движение на базата на блокове и схема за пространствена трансформация. Като цяло можем да кажем, че тези стандарти извършват компенсация на движение блок по блок от предишния реконструиран кадър с помощта на 2-D величина, наречена вектор на движение (MV), за сигнализиране на пространствено изместване. Текущият блок се формира с помощта на прогнозиране на стойностите от същия размер предишен реконструиран кадър, който е изместен от текущата позиция от вектора на движение. В крайна сметка остатъчната грешка се изчислява като разликата между прогнозирания блок с компенсация на движението и действителния блок. Тази остатъчна грешка се трансформира с помощта на линейна енергийно-уплътняваща трансформация, след което се квантува и ентропийно кодира.

Квантуваните коефициенти на трансформация се ентропийно декодират, деквантуват и обратно трансформират, за да се получи приближение на остатъчната грешка от страната на декодера, която след това се добавя към прогнозата с компенсация на движението, за да се генерира реконструкцията. Описанието на високо ниво на кодека е показано на следното изображение.

Останалата част от раздела ще обсъди новите подобрения в WMV-9, които го отличават от останалите решения за кодиране на видео като MPEG стандартите. WMV-9 има вътрешни (I), прогнозирани (P) и двупосочни прогнозирани (B) рамки. Вътрешните рамки са тези, които са кодирани независимо и не зависят от други рамки. Предсказаните рамки са рамки, които зависят от един кадър в миналото. Декодирането на предвиден кадър може да се извърши само след като всички референтни кадъра преди текущия кадър, като се започне от най-скорошния (I) кадър, са декодирани. B кадрите са кадри, които имат две препратки – една във времевото минало и една във времевото бъдеще. B-кадрите се предават след техните препратки, което означава, че B-кадрите се изпращат без ред, за да се гарантира, че техните препратки са налични по време на декодирането. B кадрите в WMV-9 не се използват като еталон за следващи кадри. Това поставя B кадри извън цикъла на декодиране, позволявайки да се предприемат преки пътища по време на декодирането на B кадри без дрейф или дългосрочни визуални артефакти. Горната дефиниция на I, P и B рамки е валидна както за прогресивни, така и за презредови последователности.

Производителността на видео кодеците се сравнява с тяхната диаграма скорост-изкривяване (RD). Това е 2-D крива, която показва изкривяването, причинено от компресията при определен битрейт.

WMV-9 адресира този проблем с въвеждането на различни техники, изброени по-долу:

1. Адаптивна трансформация на размера на блока

2. Набор от трансформации с ограничена точност

3. Компенсация на движението

4. Квантуване и деквантуване

5. Разширено ентропийно кодиране

6. Циклично филтриране

7. Разширено кодиране на B рамка

8. Преплитащо кодиране

9. Изглаждане на припокриване

10. Евтини инструменти

11. Компенсация за избледняване

## Препратки ##

* [https://bytescout.com/blog/2018/02/windows-media-video-format.html](https://bytescout.com/blog/2018/02/windows-media-video-format.html)
* [https://en.wikipedia.org/wiki/Windows_Media_Video](https://en.wikipedia.org/wiki/Windows_Media_Video)


