{
  "date" : "2020-11-11",
  "keywords" :[ "MDF", "разширение", "файл", "файлов формат", "Тип файл на база данни", "Файлов формат на база данни", "Файлове на база данни"],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Научете за файловия формат MDF и API, които могат да създават и отварят MDF файлове.",
  "title" :"MDF файлов формат - Главен файл на база данни на SQL Server",
  "linktitle" : "MDF",
  "menu" : {
    "docs" : {
      "parent" : "database"
}
},
  "lastmod" : "2020-08-12"
}

## Какво е MDF файл?

Файл с разширение .mdf е главен файл на база данни, използван от [Microsoft SQL Server](https://en.wikipedia.org/wiki/Microsoft_SQL_Server) за съхраняване на потребителски данни. Това е от първостепенно значение, тъй като всички данни се съхраняват в този файл. MDF файлът съхранява потребителски данни в релационни бази данни под формата на колони, редове, полета, индекси, изгледи и таблици. SQL Server позволява да се зададат настройки за автоматично нарастване и автоматично свиване, за да има положително въздействие върху производителността на базата данни. MDF файловете могат да бъдат заредени и прикачени към база данни с помощта на Microsoft SQL Server. MDF файловете имат тип mime Application/octet-stream.

## MDF файлов формат

Основната единица за съхранение на данни в SQL Server е страница. Страницата за съхранение, присвоена на базата данни, е разделена на логически страници, номерирани от 0 до n. Една страница започва със заглавка от 96 байта, която се състои от ID на страницата, тип структура, към която принадлежи страницата, брой записи в страницата и указатели към предишната и следващата страница.

### Файлова структура

MDF файл има следната структура на данните.

* Страница 0: Заглавка
* Страница 1: Първи PFS
* Страница 2: Първа GAM
* Страница 3: Първи SGAM
* Страница 4: Неизползвана
* Страница 5: Неизползвана
* Страница 6: Първи DCM
* Страница 7: Първи BCM

#### Заглавка на файл

Страница номер 0 на всички файлове съдържа заглавка, която съхранява метаданни за файла.

#### Свободно пространство на страницата (PFS)
PFS идентифицира състоянието на разпределението и определя количеството свободно пространство.

* Бит 1: Показва дали страницата е разпределена или не.
* Бит 2: Показва дали страницата е от смесен екстент.
* Бит 3: Показва, че тази страница е IAM страница.
* Бит 4: Показва, че тази страница съдържа призрачни записи
* Битове 5 до 7: Комбинирана трибитова стойност, която показва пълнотата на страницата, както следва:
* 0: Страницата е празна
* 1: Страницата е пълна 1–50%.
* 2: Страницата е пълна 51–80%.
* 3: Страницата е пълна на 81–95%.
* 4: Страницата е пълна 96–100%.

## Препратки

* [Файлове на бази данни и файлови групи](https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-files-and-filegroups?view=sql-server-ver15)
* [Отделяне и прикачване на база данни - SQL Server](https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-detach-and-attach-sql-server?view=sql-server -ver15)
* [Анализиране на анатомията на файла с данни на SQL Server](https://blog.pythian.com/analyzing-sql-server-data-file-anatomy/)

