{
  "date" : "2019-12-10",
  "keywords" :[ "XLSB", "файл", "разширение", "файлов формат", "Файл с двоична електронна таблица на Excel" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Вашето ръководство за файлов формат, за да знаете какво е XLSB файл и API, които могат да ги създават и отварят.",
  "title" :"Какво е XLSB файл?",
  "linktitle" : "XLSB",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## Какво е XLSB файл?

Файловият формат XLSB определя двоичния файлов формат на Excel, който е колекция от записи и структури, които определят съдържанието на работната книга на Excel. Съдържанието може да включва неструктурирани или полуструктурирани таблици с числа, текст или както числа, така и текст, формули, външни връзки към данни, диаграми и изображения. За разлика от [XLSX](/bg/spreadsheet/xlsx/) (който е базиран на Open XML файлов формат), XLSB представлява двоичен файл на работна книга на Excel. XLSB файловете могат да се четат и записват по-бързо, което ги прави полезни за работа с големи файлове. XLSB рядко се използва за съхраняване на работни книги, тъй като XLSX (и преди това [XLS](/bg/spreadsheet/xls/)) са най-често срещаните избрани от потребителя файлови формати за записване на работни книги. Може да се отвори от Microsoft Office 2007 и по-нова версия.

## Спецификации на файлов формат XLSB ##

Спецификациите на файловия формат за файловия формат XLSB бяха публикувани през 2008 г. като версия 1.0. Оттогава спецификациите бяха преразгледани няколко пъти и последната версия на спецификациите (v 10.0) беше публикувана през април 2018 г. Спецификациите са публично достъпни от Microsoft като [[MS-XLSB] - спецификации на формат на двоичен файл на Excel](https:/ /msdn.microsoft.com/en-us/library/cc313133(v#office.12).aspx) и трябва да се консултира от всеки за четене или писане на файлове във файлов формат XLSB.

## XLSB файлова структура ##

XLSB файлът е пакет, който се състои от колекция от части. Тези части съдържат информация за съдържанието на работна книга, включително данни от работна книга и структурата на пакета. Някои части съдържат информация, съхранена с помощта на двоични записи, някои като XML, докато други съдържат информация, съхранена като двоичен поток от байтове. Всеки двоичен запис съдържа нула или повече структурирани полета, които съдържат данните от работната книга.

#### Пакет ####

XLSB пакет е [ZIP](/bg/compression/zip/) архив, който трябва да съдържа точно една част от работната книга. Тази част трябва да бъде целта на връзка в тази част за връзка с пакет. Частта с работната книга е началната част в XLSB документа.

#### Част ####

Една част е поток от байтове, който има асоцииран тип съдържание, което указва естеството и типа съдържание, съхранявано в частта. Някои части съхраняват информация в двоичен формат, докато други съхраняват информация като XML. Разделът [изброяване на части](https://msdn.microsoft.com/en-us/library/dd924091(v#office.12).aspx) на документа със спецификации изброява валидните части, типове съдържание и задължителни/незадължителни връзки между всички части в пакет.

#### Връзка ####

Източникът и целевият ресурс са свързани чрез връзка. Връзките могат да бъдат:

**Връзка на пакета:** където целта е част, а източникът е пакетът като цяло

**Отношение част към част:** където целта е част, а източникът е част в пакета

**Явна връзка:** където даден ресурс е препратен от съдържанието на част източник чрез препратка към стойността на атрибут ID на елемент на връзка

**имплицитна връзка** е връзка, която не е изрична

**Вътрешна връзка:** където целта е част от пакета

**Външна връзка:** където целта е външен ресурс, който не е в пакета

#### Запис ####

Записът е основният градивен елемент, използван за съхраняване на информация за функции в работна книга. Всеки двоичен запис е последователност от байтове с променлива дължина. Двоичният запис се състои от три компонента:

* тип запис
* рекорден размер и
* данните за записа, които са специфични за този тип запис.

**Тип на запис:** Типът на записа показва типа на записа, определен от записа. Той също така определя структурата на данните за запис, специфични за този запис. Валидните типове записи са изброени в раздела [Изброяване на записи](https://msdn.microsoft.com/en-us/library/dd953057(v#office.12).aspx) на документа със спецификациите. Типът запис трябва да бъде един или два байта и трябва да бъде по-голям или равен на 128 и по-малък от 16384.

**Размер на записа:** Размерът на записа определя броя на байтовете, който определя общия размер на записаните данни. Тази стойност ТРЯБВА да бъде от един до четири байта. Тази стойност ТРЯБВА да бъде един байт, ако старшият бит в ниския байт е равен на 0; в противен случай тази стойност ТРЯБВА да е по-голяма от един байт. Ако броят на байтовете е по-голям от един байт, старшият бит във всеки следващ байт указва дали се използва допълнителен байт. Ако старшият бит на втория байт е равен на 1, тогава тази стойност ТРЯБВА да използва допълнителен трети байт. Ако старшият бит на третия байт е равен на 1, тогава тази стойност ТРЯБВА да използва допълнителен четвърти байт. Старшият бит на четвъртия байт ТРЯБВА да се игнорира. Стойността се състои от комбинираните седем ниски бита на всеки байт. Малките, най-малко значими битове се съдържат в първия байт и всеки следващ байт съдържа битове от по-висок порядък от предишния байт.

**Данни за запис:** Компонентът за данни за запис съдържа полета, които съответстват на определен тип запис и съставляват останалата част от записа. Редът и структурата на полетата за даден тип запис, изброени в Изброяване на записи, са посочени в съответния раздел за този тип запис в Записи. Общият размер на компонента на записа на данни ТРЯБВА да бъде равен на размера на записа. Полетата в компонента за запис на данни могат да съдържат прости стойности, масиви от стойности, структури от няколко полета, масиви от полета и масиви от структури.

#### Пример за XLSB запис ####

Следният тип запис и размер на записа определят запис **BrtCommentText** с размер 200 байта:

11111101 00000100 11001000 00000001 [Полета за запис]

Първият байт е 11111101, указвайки ниска стойност от 125 и че типът запис изисква втори байт. Вторият байт е 00000100, определящ висока стойност от 4 * 128, което се равнява на 512. Стойността на типа запис е 125 + 512 или 637, което съответства на тип запис **BrtCommentText**. Следващият байт е 11001000, указвайки ниска стойност от 72 и че размерът на записа изисква втори байт. Вторият байт е 00000001, указващ по-висока стойност от 1 * 128 и че размерът на записа не изисква допълнителен байт. Размерът на записа е 72 + 128 или 200, което указва общия размер в байтове на компонента на записа с данни. Полетата в компонента на данните за записа са посочени от **BrtCommentText**.

## Препратки ##

* [[MS-XLSB] - Excel (.xlsb) двоичен файлов формат](https://msdn.microsoft.com/en-us/library/cc313133(v#office.12).aspx)

