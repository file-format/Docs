{
  "date" : "2019-12-10",
  "keywords" :[ "XLSX", "файл", "разширение", "файлов формат", "Excel", "Електронна таблица" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Научете какво е XLSX файл и API, които могат да създават и отварят XLSX файлове.",
  "title" :"XLSX файлов формат – какво е XLSX файл?",
  "linktitle" : "XLSX",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## Какво е XLSX файл?

**XLSX** е добре познат формат за документи на Microsoft Excel, въведен от Microsoft с пускането на Microsoft Office 2007. Въз основа на структура, организирана в съответствие с Open Packaging Conventions, както е посочено в [Част 2](https://www .ecma-international.org/publications/standards/Ecma-376.htm) на стандарта OOXML ECMA-376, новият формат е zip пакет, който съдържа редица XML файлове. Основната структура и файлове могат да бъдат прегледани чрез просто разархивиране на .xlsx файла.

## Кратка история на файловия формат XLSX

Файловият формат XLSX беше въведен през 2007 г. и използва стандарта Open XML, адаптиран от Microsoft през 2000 г. Преди XLSX често използваният файлов формат беше [XLS](/bg/spreadsheet/xls/), който беше чист двоичен файлов формат. Новият тип файл има добавени предимства на малки размери на файлове, по-малко промени на корупция и добре форматирано представяне на изображения. Беше в началото на 2000 г., когато Microsoft реши да направи промяната, за да приспособи стандарта за **Office Open XML**. До 2007 г. този нов файлов формат стана част от Office 2007 и се поддържа и в новите версии на Microsoft Office.

## Спецификации на файловия формат XLSX

Официалните [спецификации на файлов формат XLSX](https://learn.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/2c5dee00-eff2-4b22-92b6-0738acd4475e) са достъпни онлайн от Microsoft. За да видите какво има вътре в XLSX файла, просто го преименувайте на [ZIP](/bg/compression/zip/) файл, като промените разширението му и след това го извлечете, за да видите съставните файлове на тази работна книга на Excel. Празна работна книга, когато бъде извлечена в своите файлове, има следните съставни файлове и папки.

### [Content_Types].xml ###

Това е единственият файл, който се намира на базово ниво при извличане на zip. Той изброява типовете съдържание за частите в пакета. Всички препратки към XML файловете, включени в пакета, са посочени в този XML файл.

### \_rels (папка) ###

Това е папката Relationships, която съдържа един XML файл, който съхранява връзките на ниво пакет. Връзките към ключовите части на Xlsx файловете се съдържат в този файл като URI. Тези URI идентифицират типа връзка на всяка ключова част с пакета. Това включва връзката с основния офис документ, разположен като xl/workbook.xml и други части в рамките на docProps като основни и разширени свойства.

### docProps ###

Тази папка съдържа общите свойства на документа. Те включват набор от основни свойства, набор от разширени или специфични за приложението свойства и миниатюрен преглед на документа. Празна работна книга има два файла в тази папка, а именно app.xml и core.xml. core.xml съдържа информация като автор, дата на създаване и записване и промяна. App.xml съдържа информация за съдържанието на файла.

### xl (папка) ###

Това е основната папка, която съдържа всички подробности за съдържанието на работната книга. По подразбиране има следните папки:

* \_rels
* тема
* работни листове

и следните xml файлове:

* styles.xml
* работна книга.xml

## Пример за XLSX формат ##


За всеки работен лист на Excel, съдържащ се в работна книга, има един XML файл. Можете да намерите тези XML файлове в папката xl/worksheets. Цялата информация, съдържаща се в работния лист, е организирана в различни секции в XML файла. Нека разгледаме примерен работен лист от работна книга, която е показана на следното изображение.

{{< figure src="../XLSX file format.png" alt="XLSX файлов формат" >}}

Както може да се види, този работен лист съдържа съдържание в клетки от A1 до B2 и изображение. Освен това клетка G13 в момента е активната клетка в работния лист. Сега нека разгледаме файла xl/worksheets/sheet1.xml, за да видим как тази информация е представена в XML файла. Съдържанието на този XML файл е както е показано по-долу.

{{< figure src="../XLSX File Format Details.png" alt="XPS файлов формат" >}}

1. Към раздела е приложен цвят на темата. Споменава се в XML файла с етикет<tabColor> след идентификатора на темата.
1. Стойността tabSelected е зададена на 1, което показва, че това е избраният лист
1. Както може да се види на първото изображение по-горе, клетка G13 в работния лист е активна клетка, която също се споменава в XML файла.
1. Разделът sheetData представлява данните, съдържащи се в работния лист. Можете обаче да видите, че оригиналното съдържание на работния лист не е никъде в този раздел. Това е така, защото текстът е индиректно препратен от XML лист "sharedStrings". Това свързване гарантира, че всеки текст се записва само веднъж и може да бъде препратен отново, за да се спести място.
1. Изображението, както може да се види, е посочено с референтен идентификатор "rId2"

## Допринесете

Трябва да споделите нещо за файловите формати XLSX или Spreadsheet? Можете да публикувате констатациите си в секцията [Новини във формат на файл с електронна таблица](https://news.fileformat.com/t/Spreadsheet).

## Препратки

* [[MS-XLSX] - XLSX файлов формат](https://learn.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/2c5dee00-eff2-4b22-92b6-0738acd4475e)
* [Open Office XML](http://officeopenxml.com/anatomyofOOXML-xlsx.php)

