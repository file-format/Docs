{
  "date" : "2021-02-15",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"QT ファイル形式 - クイック ムービー ファイル",
  "keywords" :[ "QT", "QuickTime ビデオ", "qt フォーマット", "qt ファイルの再生方法", "クイック ムービー ファイル", "QTFF", "ビデオ", "Apple" ],
  "description":"QT ファイル形式と,QT ファイルを作成して開くことができる API について学びます。",
  "linktitle" : "QT",
  "menu" : {
    "docs" : {
      "parent" : "video"
}
},
  "lastmod" : "2021-02-16"
}

## .QT オプション番号

拡張子が .qt のファイルは、マルチメディア ファイルのコンテンツを格納するために QuickTime フレームワークによって使用されるマルチメディア コンテナ ファイルです。 Apple Inc. によって開発された QuickTime ファイル形式 (QTFF) は、後で再生するためのオーディオ、ビデオ、またはテキストを含むマルチメディア コンテナ ファイルです。これは、デバイス、アプリケーション、およびオペレーティング システム間でのデジタル メディアの交換に最適な形式です。 QT ファイルは、Apple Inc. によって開発された [MOV](/video/mov/) 形式でも保存されます。QT ファイルを開くことができるアプリケーションには、Apple QuickTime プレーヤー、VLC メディア プレーヤー、および K-ライト コーデック パック。

## QT ファイル形式

QTFF は、オブジェクトの柔軟なコレクションを公開して解析と拡張を容易にするオブジェクト指向です。 QT ファイルの各トラックには、デジタル エンコードされたメディア ストリーム、または別のファイルにあるメディア ストリームへのデータ参照が含まれています。アトムと呼ばれるオブジェクトで構成される階層データ構造は、トラック コンテナーとして機能します。 [QT ファイル形式](https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFPreface/qtffPreface.html) のファイル形式仕様は、開発者の参照用に Apple Inc によって公式に入手可能です。

### メディアの説明

QuickTime ファイルのメディア記述は、メディア データとは別に保存されます。トラック数、ビデオ圧縮形式、タイミング情報などの情報は、メディア記述 (ムービー リソース、ムービー アトム、または単にムービーとも呼ばれます) に格納されます。メディア データは、このメディア構造のインデックスによって参照されます。メディア データは、ムービーで使用されるビデオ フレームやオーディオ サンプルなどの実際のサンプル データです。

### アトム

Atom は、QuickTime ファイルの基本単位です。どのアトムにも、他のどのフィールドよりも前に、サイズ フィールドとタイプ フィールドという 2 つの主要なフィールドがあります。 size フィールドはアトムのサイズを示し、type フィールドはアトムに格納されているデータのタイプを示します。本質的に、アトムは階層的です。つまり、1 つのアトムは他のアトムを含むことができ、他のアトムを含むことができます。サンプル アトムのレイアウトを次の図に示します。

各アトムには、ヘッダーとデータの 2 つの部分があります。ヘッダーにはサイズとタイプのフィールドが含まれ、データ部分には実際のデータが含まれます。さらに、各フィールドについて以下に説明します。

#### 原子サイズ

アトムのヘッダーと内容は、アトムのサイズとして知られる 32 ビット整数で示されます。サイズ フィールドには、32 ビットの符号なし整数で表されたバイト単位のアトムのサイズが含まれます。

#### 原子タイプ

アトムのタイプも 32 ビットの整数で示され、ムービー アトムの場合は 'moov' (0x6D6F6F76)、映画アトムの場合は 'trak' (0x7472616B) などのニーモニック値を持つ 4 文字のフィールドとして扱われることがほとんどです。トラック アトム。原子タイプがわかると、そのデータを解釈できます。

![alt text](../QT_Sample_Atom.png "QT File Format")

## ファイル構造 ##

QT/MOV ファイルは、連続したチャンクで構成されます。すべてのチャンクには 8 バイトのヘッダーがあります。4 バイトのチャンク サイズ (ビッグ エンディアン、上位バイトが最初) と 4 バイトのチャンク タイプ - 定義済みの署名の 1 つ: "ftyp"、"mdat"、"moov"、"pnot "、"udta"、"uuid"、"moof"、"free"、"skip"、"jP2"、"wide"、"load"、"ctab"、"imap"、"matt"、"kmat"、 「clip」、「crgn」、「sync」、「chap」、「tmcd」、「scpt」、「ssrc」、「PICT」。最初のチャンクは「ftype」タイプで、オフセット 8 にサブタイプがあります。サブタイプで定義された MOV は「qt」でなければなりません。 MOV ファイルを構成するには、不明なタイプが検出されるまでチャンクを反復する必要があります。

サンプルの例を次に示します。サンプルの MOV ファイルのバイナリ データを調べると、オフセット 4 の署名 **ftyp** (16 進数: 66 74 79 70) で始まることが明らかです。これは、QuickTime コンテナー ファイル タイプを定義します。ファイルのサブタイプは **qt~_~_** (16 進数: 71 74 20 20) で、MOV ファイル タイプを指します。最初のブロック サイズは 32 (16 進数: 00 00 00 20、ビッグ エンディアン、上位バイトが最初) で、サイズはオフセット 0 にあります。オフセット 32 (16 進数: 20) には、サイズが 8 で、 **mdat** (16 進数: 6D 64 61 74) と入力します。

次のチャンクはオフセット 32+8#40 (16 進数: 28) にあり、サイズは 3,263,028 (16 進数: 00 31 CA 34) で、オフセット 44 (16 進数: 16 進数: ：2C）。次のチャンクは、オフセット 40 + 3,263,028#3,263,068 (16 進数: 00 31 CA 5C) にあり、サイズは 21,189 (16 進数: 00 00 52 C5) であり、オフセットで **moov** (16 進数: 6D 6F 6F 76) とタイプされます。 1,836,019,574 (16 進数: 00 31 CA 60)。これが最後のチャンクなので、合計ファイル サイズは 3,263,068+21,189#3,284,257 バイトです。

## 参照 ##

* [QT ファイル形式 - Apple Inc.](https://developer.apple.com/library/archive/documentation/QuickTime/QTFF/QTFFPreface/qtffPreface.html)
* [QuickTime ファイル形式 - ウィキペディア](https://en.wikipedia.org/wiki/QuickTime_File_Format)

