{
  "date" : "2019-12-10",
  "keywords" :[ "XLM", "файл", "розширення", "формат файлу", "Макрофайл Microsoft Excel", "Електронна таблиця" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Ваш посібник із формату файлів, щоб дізнатися, що таке файл макросів XLM та API, які можуть створювати та відкривати файли XLM.",
  "title" :"Що таке файл XLM?",
  "linktitle" : "XLM",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## Що таке файл XLM?

XLM, для Excel Macro, є типом файлів електронних таблиць, які використовуються для зберігання макросів. З прикладної точки зору макрос — це набір інструкцій, які використовуються для автоматизації процесів. Макрос використовується для запису кроків, які повторюються для формату файлу [XLS](/uk/spreadsheet/xls/), і полегшує виконання дій шляхом повторного запуску макросу. Макроси програмуються за допомогою Microsoft Visual Basic for Applications (VBA) із робочої книги Excel за допомогою редактора Visual Basic, і їх можна запускати/налагоджувати безпосередньо звідти.

## Коротка історія ##

Microsoft Excel підтримує програмування макросів з моменту свого першого публічного запуску. Функції макросів залишалися незмінними в наступних версіях Excel із розширенням відповідно до нових функцій. XLM був мовою макросів за замовчуванням для Excel до Excel 4.0. Excel 5.0 за замовчуванням записував макроси у VBA, але у версії 5.0 запис XLM усе ще дозволявся як опція. Після версії 5.0 цю опцію було припинено. Усі версії Excel, включаючи Excel 2010, можуть запускати макрос XLM, хоча Microsoft не рекомендує їх використовувати.

## Запис макросу в XLM ##

Excel пропонує прості у використанні кроки для запису макросу. Для роботи з макросами потрібні інстальовані інструменти розробника. Коли макрос записується, він записує кожну дію користувача, яка буде відтворена пізніше. Запис макросу фактично включає в себе всі дії, які користувач виконує після початку запису. Таким чином, якщо ви виділите вміст комірки напівжирним шрифтом, курсивом і встановите її вирівнювання тексту після початку запису макросу, усі ці команди будуть записані. Кожному записаному макросу також можна призначити ярлик для швидкого відтворення пізніше. Запис макросу генерує код VBA у формі макросу, який можна редагувати за допомогою редактора Visual Basic (VBE).

## Об'єктна модель Excel ##

Для цього макроси використовують підпрограми VBA та дотримуються [об’єктної моделі Excel](https://learn.microsoft.com/en-us/office/vba/api/overview/excel/object-model). Ця модель ідентифікує об’єкти електронної таблиці для взаємодії з електронною таблицею через визначені користувачем панелі інструментів команд, панелі команд або вікна повідомлень. Наприклад, доступ до властивостей робочої книги надається за допомогою об’єкта Workbook. Так само в моделі є об’єкт Worksheet для програмної роботи з робочими аркушами книги.

## Макроси та безпека ##

VBA дозволяє отримати доступ до всіх областей застосування, а також до файлової системи, і також може бути небезпечним. Це викликає занепокоєння, якщо надати спільний доступ до книги комусь, хто може запустити файл зі свого боку. Тобто Microsoft Excel попереджає про відкриття такого файлу. Макроси можна засвідчити цифровим підписом, щоб інші користувачі могли перевірити, чи вони надійні. Таким чином, макроси можна ввімкнути після перевірки їх джерела.

## Посилання ##

* [[MS-XLS] – структура формату двійкового файлу Excel](https://msdn.microsoft.com/en-us/library/cc313154(v#office.12).aspx)
* [Програмування макросів](https://en.wikipedia.org/wiki/Microsoft_Excel#Macro_programming)

