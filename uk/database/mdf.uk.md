{
  "date" : "2020-11-11",
  "keywords" :[ "MDF", "розширення", "файл", "формат файлу", "Тип файлу бази даних", "Формат файлу бази даних", "Файли бази даних" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Дізнайтеся про формат файлу MDF та API, які можуть створювати та відкривати файли MDF.",
  "title" :"Формат файлу MDF - головний файл бази даних SQL Server",
  "linktitle" : "MDF",
  "menu" : {
    "docs" : {
      "parent" : "database"
}
},
  "lastmod" : "2020-08-12"
}

## Що таке файл MDF?

Файл із розширенням .mdf — це головний файл бази даних, який використовується [Microsoft SQL Server](https://en.wikipedia.org/wiki/Microsoft_SQL_Server) для зберігання даних користувача. Це дуже важливо, оскільки всі дані зберігаються в цьому файлі. Файл MDF зберігає дані користувачів у реляційних базах даних у формі стовпців, рядків, полів, індексів, подання та таблиць. SQL Server дозволяє встановлювати параметри автоматичного збільшення та автоматичного згортання, щоб мати позитивний вплив на продуктивність бази даних. Файли MDF можна завантажити та приєднати до бази даних за допомогою Microsoft SQL Server. Файли MDF мають тип mime Application/octet-stream.

## Формат файлу MDF

Основною одиницею зберігання даних у SQL Server є сторінка. Сторінка зберігання, призначена базі даних, розділена на логічні сторінки, пронумеровані від 0 до n. Одна сторінка починається з 96-байтового заголовка, який містить ідентифікатор сторінки, тип структури, до якої належить сторінка, кількість записів на сторінці та покажчики на попередню та наступну сторінки.

### Структура файлу

Файл MDF має таку структуру даних.

* Сторінка 0: Заголовок
* Сторінка 1: Перший PFS
* Сторінка 2: Перший GAM
* Сторінка 3: Перший SGAM
* Сторінка 4: не використовується
* Сторінка 5: не використовується
* Сторінка 6: Перший DCM
* Сторінка 7: Перший BCM

#### Заголовок файлу

Сторінка номер 0 усіх файлів містить заголовок, у якому зберігаються метадані про файл.

#### Вільне місце на сторінці (PFS)
PFS ідентифікує статус виділення та визначає обсяг вільного простору.

* Біт 1: вказує, чи виділена сторінка чи ні.
* Біт 2: вказує, чи сторінка належить до змішаного екстенту.
* Біт 3: вказує, що ця сторінка є сторінкою IAM.
* Біт 4: вказує, що ця сторінка містить записи-привиди
* Біти 5–7: комбіноване трибітове значення, яке вказує на заповненість сторінки таким чином:
* 0: сторінка порожня
* 1: сторінка заповнена на 1–50%.
* 2: сторінка заповнена на 51–80%.
* 3: сторінка заповнена на 81–95%.
* 4: сторінка заповнена на 96–100%.

## Список літератури

* [Файли бази даних і файлові групи](https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-files-and-filegroups?view=sql-server-ver15)
* [Від’єднання та приєднання бази даних – SQL Server](https://docs.microsoft.com/en-us/sql/relational-databases/databases/database-detach-and-attach-sql-server?view=sql-server -ver15)
* [Аналіз анатомії файлу даних SQL Server](https://blog.pythian.com/analyzing-sql-server-data-file-anatomy/)

