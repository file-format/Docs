{
  "date" : "2020-11-11",
  "keywords" :[ "MDF", "הרחבה", "קובץ", "פורמט קובץ", "סוג קובץ מסד נתונים", "פורמט קובץ מסד נתונים", "קבצי מסד נתונים" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"למד על פורמט קבצי MDF וממשקי API שיכולים ליצור ולפתוח קובצי MDF.",
  "title" :"פורמט קובץ MDF - קובץ מסד הנתונים הראשי של SQL Server",
  "linktitle" : "MDF",
  "menu" : {
    "docs" : {
      "parent" : "database"
}
},
  "lastmod" : "2020-08-12"
}

## מהו קובץ MDF?

קובץ עם סיומת .mdf הוא קובץ מאסטר של מסד נתונים המשמש את [Microsoft SQL Server](https://en.wikipedia.org/wiki/Microsoft_SQL_Server) לאחסון נתוני משתמשים. יש חשיבות עליונה שכן כל הנתונים מאוחסנים בקובץ זה. קובץ ה-MDF מאחסן את נתוני המשתמשים במסדי נתונים יחסיים בעמודות הטופס, בשורות, בשדות, באינדקסים, בתצוגות ובטבלאות. SQL Server מאפשר להגדיר הגדרות autogrow ו-autoshink להשפעה חיובית על ביצועי מסד הנתונים. ניתן לטעון ולצרף קבצי MDF למסד נתונים באמצעות Microsoft SQL Server. לקבצי MDF יש סוג פנטומימאי Application/octet-stream.

## פורמט קובץ MDF

היחידה הבסיסית של אחסון נתונים ב-SQL Server היא דף. דף אחסון שהוקצה למסד נתונים מחולק לדפים לוגיים המספרים מ-0 עד n. עמוד בודד מתחיל בכותרת של 96 בתים המורכבת ממזהה עמוד, סוג המבנה שאליו שייך העמוד, מספר הרשומות בעמוד ומצביעים לעמודים הקודמים והבאים.

### מבנה הקובץ

לקובץ MDF יש את מבנה הנתונים הבא.

* עמוד 0: כותרת עליונה
* עמוד 1: PFS ראשון
* עמוד 2: GAM ראשון
* עמוד 3: SGAM ראשון
* עמוד 4: לא בשימוש
* עמוד 5: לא בשימוש
* עמוד 6: DCM ראשון
* עמוד 7: BCM ראשון

#### כותרת הקובץ

העמוד מספר 0 של כל הקבצים מכיל כותרת שמאחסנת מטא נתונים על הקובץ.

#### דף פנוי (PFS)
PFS מזהה את מצב ההקצאה וקובע את כמות השטח הפנוי.

* Bit 1: מציין אם הדף מוקצה או לא.
* סיביות 2: מציינת אם הדף הוא בהיקף מעורב.
* ביט 3: מציין שדף זה הוא דף IAM.
* סיביות 4: מציינת שדף זה מכיל רשומות רפאים
* סיביות 5 עד 7: ערך משולב של שלוש סיביות, המציין את מלאות העמוד באופן הבא:
* 0: הדף ריק
* 1: הדף מלא ב-1-50%.
* 2: העמוד מלא ב-51-80%.
* 3: העמוד מלא ב-81–95%.
* 4: העמוד מלא ב-96-100%.

## הפניות

* [קבצי מסד נתונים וקבוצות קבצים](https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-files-and-filegroups?view=sql-server-ver15)
* [נתק וצרף מסד נתונים - SQL Server](https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-detach-and-attach-sql-server?view=sql-server -ver15)
* [ניתוח SQL Server Data File Anatomy](https://blog.pythian.com/analyzing-sql-server-data-file-anatomy/)

