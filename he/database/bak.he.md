{
  "date" : "2020-11-11",
  "keywords" :[ "BAK", "סיומת", "קובץ", "פורמט קובץ", "סוג קובץ BAK", "סיומת קובץ BAK", "סוג קובץ מסד נתונים", "פורמט קובץ מסד נתונים", "קבצי מסד נתונים" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"למד על פורמט קובץ BAK וממשקי API שיכולים ליצור ולפתוח קובצי BAK.",
  "title" :"פורמט קובץ BAK - קובץ גיבוי של מסד נתונים",
  "linktitle" : "BAK",
  "menu" : {
    "docs" : {
      "parent" : "database"
}
},
  "lastmod" : "2020-12-04"
}

## מהו קובץ BAK?

קובץ עם סיומת .bak הוא בדרך כלל קובץ גיבוי המשמש כלי תוכנה שונים לאחסון גיבויים של נתונים. מנקודת מבט של מסד נתונים, קובץ BAK משמש את Microsoft SQL Server לאחסון התוכן של מסד נתונים. כל הנתונים והקבצים המשויכים למסד הנתונים מאוחסנים בפורמט קובץ זה כדי לאחזר אותו למקרה שמסד הנתונים עלול להיות פגום או לא חוקי מכל סיבה שהיא. ניתן לאחסן ולהוסיף את קבצי הגיבוי בשרתים אחרים למטרות בטיחות. מספר יישומים יכולים ליצור קובצי BAK כגון SQL Server Management Studio, Transact-SQL ו-Windows PowerShell.

## פורמט קובץ BAK

הפרטים הפנימיים של קובץ BAK אינם ידועים, אך ההנחה הרווחת היא שהוא מבוסס על Microsoft Tape Format (MTF). מפרטי MTF זמינים וניתן לעיין בהם להבנת מבנה הקובץ. המסמך מספק פרטים על אחסון MTF לכל מי שיש לו ידע כללי על פעולות ניהול אחסון, כונני טייפ ומערכות קבצים.

### מערכי נתונים

ערכת נתונים היא אוסף של אובייקטים שנכתבו למדיית אחסון (קלטת, דיסק אופטי וכו') במהלך גיבוי או שחזור נתונים. ערכות נתונים מורכבות ממספר מדיה במקרה של נפח גדול של נתונים.

### אלמנטים בסיסיים של MTF

קובץ MTF מורכב מכמה אלמנטים בסיסיים המהווים את אבני הבניין שלו. אלמנטים אלו הם:

#### חסימות תיאור

בלוקים מתארים (DBLK) משמשים לבקרת פורמט ומהווים את היסודות העיקריים של קובץ MTF. קובץ MTF יחיד מגדיר מספר DBLKs עבור כל תפקיד ייחודי. כל DBLK הוא בלוק נתונים באורך משתנה המחולק לארבעה החלקים הבאים:

* `Common Block Header` - מבנה באורך קבוע המשותף לכל ה-DBLKs. זהו כותרת החסימה היחידה הנדרשת.
* `מידע על סוג DBLK` - בלוק באורך קבוע ספציפי לסוג ה-DBLK המוגדר
* `נתוני מערכת הפעלה` - נתונים ספציפיים המוגדרים על סמך סוג ה-DBLK ומערכות ההפעלה
* `DBLK Information` - מידע ספציפי של DBLK באורך משתנה שלא ניתן לשמור עם מידע DBLK Fixed Length.

 {{< figure src="../bak.png" alt="פורמט קובץ גיבוי של Microsoft SQL" >}}

#### זרם נתונים

זרמי נתונים בקובץ MTF משמשים לכיסת נתונים ויישור. הוא מורכב מכותרת זרם, ואחריה נתוני הזרם. כותרת זרם יכולה להכיל רק סוג יחיד של נתוני זרם.

{{< figure src="../bak_datastream.png" alt="פורמט קובץ גיבוי של Microsoft SQL" >}}

#### סימני קבצים

סימן קובץ משמש להפרדה לוגית וגישה מהירה בתוך מדיה. סימני קובץ מחוקים על ידי מנהל ההתקן או על ידי שימוש בגוש Soft Filemark Descriptor למקרה שהמכשיר שבשימוש אינו מספק סימני קובץ.

## הפניות ##

* [[MS-BCP]: פורמט העתקה בכמות גדולה](https://learn.microsoft.com/en-us/openspecs/sql_data_portability/ms-bcp/54965c4d-34c7-400d-b970-1007984315a5)

