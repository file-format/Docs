{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"פורמט קובץ WMV",
  "description":"למד על פורמט קובץ WMV וממשקי API שיכולים ליצור ולפתוח קובצי WMV.",
  "linktitle" : "WMV",
  "menu" : {
    "docs" : {
      "parent" : "video"
}
},
  "lastmod" : "2019-09-16"
}

## מהו קובץ WMV?

פורמט המערכות המתקדמות (ASF) הוא מיכל מולטימדיה דיגיטלי המיועד בעיקר לאחסון והעברת זרמי מדיה. Microsoft Windows Media Video (WMV) הוא פורמט הווידאו הדחוס ו-Microsoft Windows Media Audio (WMA) הוא פורמט האודיו הדחוס יחד עם מטא נתונים נוספים במיכל ה-ASF שפותח על ידי Microsoft. לאחר שקובצי ה-WMV או ה-WMA מקודדים ב-Windows Media Video ו-Windows Media Audio, הם מיוצגים עם סיומת .asf. WMV דוחס קבצים גדולים לקצב שידור טוב יותר ברשת תוך שמירה על איכות הווידאו. WMV תוכנן במיוחד להפעלה על כל מכשירי Windows. לאחר התקינה על ידי האגודה למהנדסי קולנוע וטלוויזיה (SMPTE), WMV נחשב כעת לפורמט סטנדרטי פתוח.

## היסטוריה ##

בעזרת קודקים קנייניים של מיקרוסופט פותח בשנת 1999 פורמט וידאו דחוס חדש המכונה WMV7 שהתבסס על MPEG-4 חלק 2. שיפורים נוספו בשתי גרסאות נוספות, כלומר WMV8 ו-9. מיקרוסופט הגישה גרסה 9^^th^^ של WMV ל-SMPTE לתקינה בשנת 2003, אשר בסופו של דבר תוקנה בשנת 2006 כ-SMPTE 421M הידוע גם בשם VC-1. הרעיון מאחורי ה-WMV היה לפתח פורמט מדיה שיכול להיתמך על ידי כל החומרה והתוכנה הנתמכים על ידי מיקרוסופט. יתר על כן, מטרה מרכזית נוספת הייתה העברת זרמי וידאו דרך האינטרנט בתרחיש אופטימלי. לאחר הסטנדרטיזציה מ-SMPTE, WMV הפך גם לפורמט וידאו עבור תקליטורי Blu-ray.

## מפרטי פורמט קובץ

### מיכל

בדרך כלל, WMV נארז לתוך מיכל ASF אך בנוסף, מיכל Matroska או AVI יכולים לתמוך בו גם עם הרחבות של .mkv ו-.avi בהתאמה.

### Windows Media Video 9

למרות שקיימים רכיבי קוד אודיו ווידאו שונים בסדרת Windows Media Video 9 ליצירה והשמעה של מדיה דיגיטלית, ה-Codec WMV-9 הוא ה-Codec הווידאו העדכני והטוב ביותר שכן הוא יכול להשיג את הדחיסה האופטימלית מקצבי סיביות נמוכים מאוד, כלומר 160 x 120 ב-10 Kbps עד 1920 x 1080 ב-4-8 Mbps עבור מגוון סרטוני HD.

### מבנה ה-Codec

ל-WMV-9 יש פורמט צבע פנימי של 8 סיביות 4:2:0. כמו כל שאר תקני דחיסת הווידאו הפופולריים MPEG-1 ו-H.261, WMV-9 משתמש בסכמת פיצוי תנועה מבוססת בלוק ותמרה מרחבית. באופן כללי, אנו יכולים לומר שתקנים אלו מבצעים פיצוי תנועה בלוק אחר בלוק מהמסגרת המשוחזרת הקודמת בעזרת כמות דו-ממדית הנקראת וקטור התנועה (MV) לאותת תזוזה מרחבית. הבלוק הנוכחי נוצר בעזרת חיזוי הערכים מאותו גודל של מסגרת משוחזרת קודמת אשר נעקרה מהמיקום הנוכחי על ידי וקטור התנועה. בסופו של דבר, השגיאה השיורית מחושבת כהפרש בין הבלוק החזוי מפיצוי התנועה לבין הבלוק בפועל. שגיאה שיורית זו עוברת טרנספורמציה באמצעות טרנספורמציה לינארית דחיסת אנרגיה ולאחר מכן מכומדת ומקודדת אנטרופיה.

מקדמי טרנספורמציה קוונטיים מפוענחים אנטרופיה, מפורקים ומומרים הפוכים כדי לייצר קירוב של השגיאה השיורית בצד המפענח, אשר מתווספת לאחר מכן לחיזוי מפיצוי תנועה כדי ליצור את השחזור. התיאור ברמה הגבוהה של ה-codec מוצג בתמונה הבאה.

שאר הסעיף ידון בשיפורים החדשים ב-WMV-9 המבדילים אותו משאר פתרונות קידוד הווידאו כמו תקני MPEG. ל-WMV-9 יש מסגרות תוך (I), חזויה (P) וחזויה דו-כיוונית (B). Intra-frames הן אלו שמקודדות באופן עצמאי ואין להן תלות במסגרות אחרות. פריימים חזויים הם פריימים התלויים בפריים אחד בעבר. פענוח של מסגרת חזויה יכול להתרחש רק לאחר שפוענחו כל מסגרות ההתייחסות לפני המסגרת הנוכחית החל מהמסגרת העדכנית ביותר (I). מסגרות B הן מסגרות שיש להן שתי הפניות - אחת בעבר הזמני ואחת בעתיד הזמני. מסגרות B משודרות לאחר הפניות שלהן, כלומר מסגרות B נשלחות ללא סדר כדי להבטיח שההפניות שלהן זמינות בזמן הפענוח. מסגרות B ב-WMV-9 אינן משמשות כאסמכתא עבור מסגרות עוקבות. פעולה זו ממקמת פריימים B מחוץ ללולאת הפענוח, ומאפשרת לבצע קיצורי דרך במהלך הפענוח של פריימים B ללא סחיפה או חפצים חזותיים ארוכי טווח. ההגדרה שלעיל של מסגרות I, P ו-B תופסת הן עבור רצפים פרוגרסיביים והן עבור רצפים משולבים.

הביצועים של רכיבי Codec של וידאו מושווים לעלילה של עיוות קצב (RD). זו עקומה דו מימדית שמראה את העיוות שנוצר מהדחיסה בקצב סיביות מסוים.

WMV-9 טיפלה בבעיה זו עם הצגת מגוון טכניקות המפורטות להלן:

1. טרנספורמציה בגודל בלוק אדפטיבי

2. סט טרנספורמציה דיוק מוגבל

3. פיצויי תנועה

4. קוונטיזציה ודקוונטיזציה

5. קידוד אנטרופיה מתקדם

6. סינון לולאות

7. קידוד מסגרת B מתקדם

8. קידוד שזור

9. החלקת חפיפה

10. כלים בשיעור נמוך

11. פיצוי דועך

## הפניות ##

* [https://bytescout.com/blog/2018/02/windows-media-video-format.html](https://bytescout.com/blog/2018/02/windows-media-video-format.html)
* [https://en.wikipedia.org/wiki/Windows_Media_Video](https://en.wikipedia.org/wiki/Windows_Media_Video)


