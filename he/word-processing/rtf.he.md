{
  "date" : "2019-10-11",
  "keywords" :[ "קובץ rtf", "פורמט קובץ rtf", "מהו קובץ rtf", "קובץ", "דוגמה rtf", "סיומת קובץ rtf","הרחבה", "פורמט" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"RTF - פורמט טקסט עשיר",
  "description":"למד על פורמט קובץ RTF וממשקי API שיכולים ליצור ולפתוח קובצי RTF.",
  "linktitle" : "RTF",
  "menu" : {
    "docs" : {
      "parent" : "word-processing"
}
},
  "lastmod" : "2019-09-10"
}

## מהו קובץ RTF?

הוצג ותועד על ידי מיקרוסופט, פורמט הטקסט העשיר (**RTF**) מייצג שיטה לקידוד טקסט וגרפיקה מעוצבים לשימוש בתוך יישומים. הפורמט מקל על החלפת מסמכים בין פלטפורמות עם מוצרי Microsoft אחרים, ובכך משרת את המטרה של יכולת פעולה הדדית. יכולת זו הופכת אותו לסטנדרט של העברת נתונים בין תוכנות עיבוד תמלילים, ומכאן שניתן להעביר תוכן ממערכת הפעלה אחת לאחרת מבלי לאבד את עיצוב המסמך. מפרטי פורמט הקובץ זמינים על ידי מיקרוסופט לציבור [הורדה](https://interoperability.blob.core.windows.net/files/Archive_References/%5bMSFT-RTF%5d.pdf) וניתן להתייחס אליהם מנקודת המבט של המפתח.

## היסטוריה קצרה של פורמט קובץ RTF ##

פורמט קובץ RTF עבר מספר תיקונים מאז פרסומו. הגרסה הרשמית שלו לקריאה/כתיבה פורסמה כחלק מ-Microsoft Word 3.0 למקינטוש עם מפרטי גרסה 1.0. הגרסה הסופית של המפרט, 1.9.1 פורסמה על ידי מיקרוסופט במרץ 2008. לא יבוצעו שיפורים נוספים למפרטים לאחר מכן. נכון לעכשיו, כמעט לכל מערכות ההפעלה יש יותר יישומים עשירים בתכונות שהפחיתו/הכחידו את השימוש בפורמט קובץ RTF.

## מפרטי פורמט קובץ RTF ##

RTF משמש כסטנדרט להעברת נתונים בין תוכנת עיבוד תמלילים והעברת תוכן ממערכת הפעלה אחת לאחרת. הדבר מושג באמצעות מילות בקרה שהוצגו על ידי Microsoft Office Word עד 2007. קובץ RTF סטנדרטי מורכב מ-ASCII לייצוג טקסט עשיר ועם תווים שאינם ASCII המומרים לערכי קוד מתאימים. גרסאות חדשות יותר של Word יכולות לקרוא קבצי RTF שנוצרו עם גרסאות קודמות, בעוד שהגרסאות הישנות יותר מתעלמות ממילות בקרה ומקבוצות שהם לא מבינים.

### הבנת היסודות של RTF ###

קובצי RTF משתמשים בטקסט ASCII רגיל של 7 סיביות, המורכב מ:

* מילות בקרה
* סמלי שליטה, ו
*קבוצות.

אלה משמשים כאבני הבניין לייצוג נתוני RTF כקידוד טקסט מובן ותווים.

#### מילת בקרה ####

אלה מייצגים פקודה מעוצבת במיוחד המשמשת לסימון תווים לתצוגה ואינה יכולה להיות ארוכה מ-32 אותיות. מילת בקרה מוגדרת על ידי:

\<ASCII Letter Sequence> //<//Delimiter//> //

כל מילת בקרה היא תלוית רישיות ומתחילה עם קו נטוי אחורי. רצף אותיות ASCII יכול להכיל אלפבית ASCII (a עד z ו-A עד Z). ה<Delimite> מסמן את סוף שם מילת הבקרה ויכול להיות אחד מהבאים:

* מרחב. זה משמש רק לתיחום מילת בקרה ומתעלמים ממנו בעיבוד שלאחר מכן.
* ספרה מספרית או סימן מינוס ASCII, המציין שפרמטר מספרי משויך למילת הבקרה. הרצף הדיגיטלי שלאחר מכן מופרד על ידי כל תו מלבד ספרת ASCII (בדרך כלל מילת בקרה נוספת שמתחילה בקו נטוי אחורי). הפרמטר יכול להיות מספר עשרוני חיובי או שלילי. טווח הערכים של המספר הוא נומינלי -32768 עד 32767, כלומר מספר שלם של 16 סיביות בסימן. מספר קטן של מילות בקרה לוקחות ערכים בטווח -2,147,483,648 עד 2,147,483,647 (מספר שלם בסימן 32 סיביות). מילות בקרה אלו כוללות **\binN**, **\revdttmN//**, **\rsidN** מילות בקרה הקשורות וכמה מאפייני תמונה כמו **\bliptagN**. כאן **N** מייצג את הפרמטר המספרי. מנתח RTF חייב לאפשר עד 10 ספרות שלפניהן סימן מינוס אופציונלי. אם המפריד הוא רווח, הוא נמחק, כלומר, הוא לא נכלל בעיבוד שלאחר מכן.
* כל תו מלבד אות או ספרה. במקרה זה, התו התוחם מסיים את מילת הבקרה ואינו חלק ממילת הבקרה. כמו נטוי אחורי "\", שמשמעותו מילת בקרה חדשה או סמל בקרה אחריו.

#### סמל בקרה ####

סמל בקרה מייצג התרחשות מיוחדת שיש לה משמעות ספציפית בהתאם לתוכן שלה. הוא מורכב מקו נטוי ואחריו תו מיוחד (תו לא אלפביתי) ואין לו שום תוחם.

#### קבוצה ####

קבוצה יכולה להיות מורכבת מטקסט, מילות בקרה או סמלי בקרה המוקפים בסוגריים (**{ }**). הסוגר הפותח (**{**) מציין את תחילת הקבוצה והסוגר הסוגר (**}**) מציין את סיום הקבוצה. כל קבוצה מציינת את הטקסט המושפע מהקבוצה ואת התכונות השונות של אותו טקסט.

### מבנה קובץ RTF ###

לקובץ RTF יש את התחביר הסטנדרטי הבא:

הוצג ותועד על ידי מיקרוסופט, פורמט הטקסט העשיר (**RTF**) מייצג שיטה לקידוד טקסט וגרפיקה מעוצבים לשימוש בתוך יישומים. הפורמט מקל על החלפת מסמכים בין פלטפורמות עם מוצרי Microsoft אחרים, ובכך משרת את המטרה של יכולת פעולה הדדית. יכולת זו הופכת אותו לסטנדרט של העברת נתונים בין תוכנות עיבוד תמלילים, ומכאן שניתן להעביר תוכן ממערכת הפעלה אחת לאחרת מבלי לאבד את עיצוב המסמך. מפרטי פורמט הקובץ זמינים על ידי מיקרוסופט לציבור [הורדה](https://interoperability.blob.core.windows.net/files/Archive_References/%5bMSFT-RTF%5d.pdf) וניתן להתייחס אליהם מנקודת המבט של המפתח.

#### כותרת RTF ####

לכותרת RTF יש את הייצוג הבא.

|שדה|תיאור
---|---|
|\<header> |**\rtf1\fbidis**? \<character set> \<from> ? \<deffont> \<deflang> \<fonttbl> ? \<filetbl> ? \<colortbl> ? \<stylesheet> ? \<stylerestrictions> ? \<listtables> ? \<revtbl> ? \<rsidtable> ? \<mathprops> ? \<generator> ?

טבלאות כותרות חייבות להופיע בסדר הזה אם הן קיימות. קובץ ה-RTF יכול לכלול קבוצות של גופנים, סגנונות, צבע מסך, תמונות, הערות שוליים, הערות (ביאורים), כותרות עליונות ותחתונות, מידע סיכום, שדות, סימניות, מאפייני עיצוב מסמכים, סעיפים, פסקה ותווים, מתמטיקה, תמונות וחפצים. אם הגופן, הקובץ, הסגנון, הצבע, סימן הגרסה וקבוצות מידע סיכום ומאפייני עיצוב מסמכים כלולים בקובץ, הם חייבים להופיע בכותרת ה-RTF, הקודמת לגוף ה-RTF. אם לא נעשה שימוש בתוכן של קבוצה כלשהי, ניתן להשמיט את הקבוצה. כל קבוצה שמשתמשת במאפיינים שהוגדרו בקבוצה אחרת חייבת להופיע אחרי הקבוצה שמגדירה את המאפיינים האלה. לדוגמה, מאפייני צבע וגופן חייבים להקדים את קבוצת הסגנונות.

#### גרסת RTF ####

מסמך RTF חייב להתחיל בששת התווים הבאים:

```
{\rtf1
```
כאשר ה-1 מציג את מספר גרסת ה-RTF.

#### סט תווים ####

לאחר ה-{\rtf1, המסמך צריך להצהיר באיזו מערכת תווים הוא משתמש. הדרך להכריז על ערכת תווים היא באמצעות אחת מהפקודות הבאות:

`\ansi` - המסמך נמצא בערכת התווים ANSI, הידועה גם בשם Code Page 1252, ערכת התווים הרגילה של MSWindows.

`\mac` - המסמך נמצא בערכת התווים MacAscii, ערכת התווים הרגילה תחת גרסאות ישנות (קדם-10) של Mac OS.

`\pc` - המסמך נמצא ב-DOS Code Page 437, ערכת התווים המוגדרת כברירת מחדל עבור MS-DOS. קלדנים עם זיכרון שריר טוב ישימו לב שזו מערכת התווים שעדיין משמשת לפירוש קודים "Alt מספריים" - כלומר, כאשר אתה מחזיק Alt ומקליד "130" בלוח המקשים הנומרי, זה מייצר é, כי תו 130 ב-CP437 הוא é. זה בערך השימוש היחיד ש-CP437 רואה בימים אלה.

`\pca` - המסמך נמצא ב-DOS Code Page 850, הידוע גם בשם MS-DOS Multilingual Code Page.

#### פקודת גופן ####

אחרי הגדרת ערכת התווים מופיעה הפקודה `\deffN`. זה מגדיר שמספר הגופן N הוא גופן ברירת המחדל עבור מסמך זה. מספר הגופן N מופנה מטבלת הגופנים. הפקודה `\deffN` היא אופציונלית מבחינה טכנית, אבל היא צריכה להיות שם כדי להיות על הצד הבטוח בתור פרולוג נפוץ כמו בחירה בגופן 0 כגופן ברירת המחדל.

`{\rtf1\ansi\deff0`

#### טבלת גופנים ####

כל הגופנים שניתן להשתמש בהם במסמך מפורטים בטבלת גופנים כאשר כל גופן מיוצג על ידי מספר גופן. למסמך חייבת להיות טבלת גופנים למרות שחלק מהתוכניות יעבדו גם בלי זה.

התחביר של טבלת גופנים הוא {\fonttbl //...declarations//...}, שבו לכל הצהרה יש את התחביר הבסיסי הזה:

`{\fnumber\familycommand Fontname;}`

טבלת גופנים עם ארבע הצהרות היא כדלקמן:

```
{\fonttbl
{\f0\froman Times;}
{\f1\fswiss Arial;}
{\f2\fmodern Courier New;}
}
```

במסמך עם טבלת גופנים זו, `{\f2 stuff}` ידפיס "דברים" ב-Courier New. לא ניתן להשתמש בגופן במסמך עד שהוא מופיע בטבלת הגופנים.

### סוף מסמך ###

כל מסמך RTF חייב להסתיים ב-}, כדי לסגור את הקבוצה שנפתחה על ידי ה-{ שהוא התו הראשון במסמך. שום דבר לא יכול לעקוב אחר ה-} האחרון, מלבד אולי שורה חדשה.

## הפניות ##

* [מפרט RTF 1.9.1](https://interoperability.blob.core.windows.net/files/Archive_References/%5bMSFT-RTF%5d.pdf)
* [פורמט טקסט עשיר](https://en.wikipedia.org/wiki/Rich_Text_Format)

