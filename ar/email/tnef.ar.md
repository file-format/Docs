{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
} ,
  "draft" : "false",
  "toc" : true,
  "title" :"TNEF" ,
  "description":"تعرف على تنسيق ملف TNEF وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات TNEF وفتحها." ,
  "linktitle" : "TNEF",
  "menu" : {
    "docs" : {
      "parent" : "email"
}
} ,
  "lastmod" : "2019-09-10"
}

## ما هو ملف TNEF؟

تنسيق التغليف المحايد للنقل (TNEF) هو ملكية خاصة لشركة Microsoft ، لتغليف مرفقات البريد الإلكتروني استنادًا إلى واجهة برمجة تطبيقات المراسلة (** MAPI **). يدعم كل من Microsoft Outlook و Microsoft Exchange Server TNEF بالكامل بينما يقوم لاحقًا بفك ترميز TNEF إلى MAPI ويعرض الرسائل المنسقة. مرفق البريد الإلكتروني مع ترميز TNEF له نوع MIME من MS-TNEF ويتم تخزينه كـ winmail / win.dat. يتضمن المرفق في winmail .dat المعلومات التالية:


| الرسالة | كائنات OLE | ميزات Outlook
---|---|---|
|<ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> مرفقات الرسالة الأصلية</li><li style=";text-align:right;direction:rtl"> النسخة الأصلية المنسقة</li><li style=";text-align:right;direction:rtl"> الخطوط وأحجام النص وألوان النص</li></ul> |<ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> الصور المضمنة</li><li style=";text-align:right;direction:rtl"> مستندات Office المضمنة</li></ul> |<ul style=";text-align:right;direction:rtl"><li style=";text-align:right;direction:rtl"> النماذج المخصصة</li><li style=";text-align:right;direction:rtl"> أزرار التصويت</li><li style=";text-align:right;direction:rtl"> طلبات الاجتماع</li></ul>


تقدم خدمات البريد الإلكتروني الأخرى التي لا تدعم TNEF نصًا عاديًا للرسائل المنسقة عبر TNEF. يقوم Outlook بتضمين تنسيق منسق للرسالة في ملفات TNEF (OLE) أو ميزات Outlook معينة (النماذج وأزرار الاقتراع وطلبات المؤتمرات). لا يمكن فرض عقوبات على ترميز TNEF الصريح داخل عميل البريد الإلكتروني في Outlook ، ومع ذلك ، فإن اختيار تنسيق RTF لإرسال بريد إلكتروني يسهل ضمنيًا تشفير TNEF.

## تنسيق ملف TNEF

تنشئ خوارزمية بيانات TNEF بنية مسطحة من خصائص الرسالة الهرمية الغنية. ثم تستخدم هذه الهياكل المسطحة لتمثيل دفق بيانات تسلسلي يتكون من خصائص معينة.

في بعض الحالات ، حيث تحدث الخصائص في مجموعات أو تحتوي على قيم متعددة ، قد يشتمل الدفق على أعداد وحشوات لفرض محاذاة بيانات معينة. هناك موقف مميز يكون فيه استخدام هذه الخوارزمية مفيدًا في بيئة مراسلة غير داعمة. في مثل هذه البيئات ، يتم ترميز خاصية الرسائل الغنية في دفق بيانات تسلسلي بواسطة كاتب TNEF. علاوة على ذلك ، يمكن تغليف الخصائص التي لا تنتمي إلى TNEF الأساسي أثناء الإرسال. ثم يتم توفير هذه الخصائص المغلفة عن طريق فك التشفير من خلال TNEF لضمان توفر جميع خصائص الرسالة الأصلية لتطبيق العميل.

في TNEF ، تكون جميع أنواع البيانات الرقمية صغيرة الحجم ويكون حجمها أكبر من بايت واحد. تتطلب معالجة هذه القيم الرقمية على الأنظمة الأساسية غير الصغيرة إنجاز التحولات المناسبة للحصول على القيم الصحيحة. يتم تمثيل قيم السلسلة بتنسيق Backus-Naur Form (ABNF) وفقًا لمواصفات [RFC5234]. عندما تنتهي السلسلة بحرف فارغ ، يتم تضمينها أيضًا ؛ على سبيل المثال ، "worker@specimen.com"٪ x00.

{{< figure src="../TNEF.png" alt="تنسيق ملف TNEF" >}}

## سمات TNEF وقواعد المعالجة ##

يبدأ دفق البيانات في TNEF برقم إصدار قديم وتوقيع وقيمة مفتاح أولية وتمثل سمة صفحة التعليمات البرمجية. يتم إنشاء صفحة الرموز هذه عندما يسجل برنامج التشفير سمات وخصائص ANSI. بعد ذلك ، أصبح الدفق سلسلة من السمات التي تصطف فيها سمات الرسالة أولاً ثم تليها سمات المرفقات. توجد خصائص مختلفة للرسالة والمرفقات في سمات خاصة مثل attMsgProps و AttAttachment و attRecipTable. تحتوي السمات التي تظهر في دفق TNEF على البنية وخصائص الرسالة والتحويلات اللازمة لإشراكهم في خصائص الرسالة. تتكون كل سمة من معرف وحجم وبيانات السمة ومجموع اختباري ومستوى وفقًا لتطبيقها.

## العلاقة بالبروتوكولات والخوارزميات الأخرى ##

تحتاج الأنظمة التي لديها آلية ضعيفة لعرض تنسيق الرسائل الغنية في الأصل إلى خوارزمية بيانات TNEF للنقل. باستخدام نوع الوسائط ms-TNEF ، يتكون ناتج الخوارزمية من ملف مرفق (winmail.dat) وجزء أساسي من MIME المحدد في [RFC2045]. يتم إرسال نص الرسالة ذات النص العادي باستخدام UUENCODE وفقًا لمواصفات [MSDN-UAF] ونص الرسالة هذا أو الطريقة المكافئة التي يتم فك تشفيرها في نهاية المستلم. علاوة على ذلك ، يمكن لـ TNEF نقل بيانات الرسائل باستخدام بروتوكولات الإنترنت المختلفة مثل SMTP و POP3 و IMAP4 ، وتدمج MIME وفقًا لمعيار RFC2045.

## بيان قابلية التطبيق ##

بالإضافة إلى إرسال الرسائل البسيط ، كان من المقرر إنشاء التطبيق الأصلي لـ TNEF لاستخدام فئات الرسائل ودعم الميزات الإضافية التي ليس لها دعم أصلي في بروتوكول النقل. تم تحسين هذا التطبيق بشكل أكبر لنقل خصائص الرسائل الغنية والخصائص المسماة التي يستخدمها عملاء المراسلة الحديثة الآن. للامتثال للتنفيذ الأصلي ، يتم الاحتفاظ ببنية السمة الأصلية وتحتفظ السمة الخاصة بخصائص الرسالة الجديدة بشكل منفصل.

## مراجع

* [تنسيق تغليف محايد للنقل](https://en.wikipedia.org/wiki/Transport_Neutral_Encapsulation_Format)
* [عناوين البريد الإلكتروني ودفاتر العناوين في Exchange Server](https://learn.microsoft.com/en-us/exchange/email-addresses-and-address-books/email-addresses-and-address-books؟view# exchserver-2019)
* [[MS-OXTNEF]: خوارزمية بيانات تنسيق النقل المحايد (TNEF)](https://msdn.microsoft.com/en-us/library/cc425498 (v # exchg.80) .aspx)

