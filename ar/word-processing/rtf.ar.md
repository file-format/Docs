{
  "date" : "2019-10-11",
  "keywords" :["ملف rtf" , "تنسيق ملف rtf" , "ما هو ملف rtf" , "ملف" , "مثال rtf" , "امتداد ملف rtf" , "امتداد" , "تنسيق"] ,
  "author" : {
    "display_name" : "Kashif Iqbal"
} ,
  "draft" : "false",
  "toc" : true,
  "title" :"RTF - تنسيق نص منسق" ,
  "description":"تعرف على تنسيق ملف RTF وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات RTF وفتحها." ,
  "linktitle" : "RTF",
  "menu" : {
    "docs" : {
      "parent" : "word-processing"
}
} ,
  "lastmod" : "2019-09-10"
}

## RTF ما ه

تم تقديمه وتوثيقه بواسطة Microsoft ، يمثل Rich Text Format (** RTF **) طريقة لترميز النص والرسومات المنسقة للاستخدام داخل التطبيقات. يسهل التنسيق تبادل المستندات عبر الأنظمة الأساسية مع منتجات Microsoft الأخرى ، وبالتالي يخدم غرض قابلية التشغيل البيني. هذه الإمكانية تجعلها معيارًا لنقل البيانات بين برامج معالجة الكلمات ، وبالتالي ، يمكن نقل المحتويات من نظام تشغيل إلى آخر دون فقدان تنسيق المستند. تتوفر مواصفات تنسيق الملف بواسطة Microsoft لـ [التنزيل] العام (https://interoperability.blob.core.windows.net/files/Archive_References/%5bMSFT-RTF%5d.pdf) ويمكن الرجوع إليها من منظور المطور.

## تاريخ موجز لتنسيق ملف RTF ##

خضع تنسيق ملف RTF لعدة مراجعات منذ نشره. تم نشر نسخته الرسمية للقراءة / الكتابة كجزء من Microsoft Word 3.0 لنظام التشغيل Macintosh بمواصفات الإصدار 1.0. تم نشر الإصدار الأخير من المواصفات 1.9.1 بواسطة Microsoft في مارس 2008. ولم يتم إجراء المزيد من التحسينات على المواصفات بعد ذلك. في الوقت الحالي ، تحتوي جميع أنظمة التشغيل تقريبًا على المزيد من التطبيقات الغنية بالميزات التي قللت / ألغت استخدام تنسيق ملف RTF.

## مواصفات تنسيق ملف RTF ##

يعمل RTF كمعيار لنقل البيانات بين برامج معالجة الكلمات ونقل المحتوى من نظام تشغيل إلى آخر. يتم تحقيق ذلك باستخدام كلمات التحكم التي تم تقديمها بواسطة Microsoft Office Word حتى عام 2007. يتكون ملف RTF القياسي من ASCII لتمثيل نص منسق وبأحرف غير ASCII يتم تحويلها إلى قيم التعليمات البرمجية المناسبة. يمكن للإصدارات الأحدث من Word قراءة ملفات RTF التي تم إنشاؤها باستخدام الإصدارات السابقة ، بينما تتجاهل الإصدارات القديمة كلمات التحكم والمجموعات التي لا يفهمونها.

### فهم أسس RTF ###

تستخدم ملفات RTF نصًا عاديًا ASCII 7 بت ، ويتألف من:

* التحكم بالكلمات
* رموز التحكم و
* مجموعات.

هذه بمثابة اللبنات الأساسية لتمثيل بيانات RTF كنص مفهوم وترميز الأحرف.

#### التحكم في الكلمات ####

تمثل هذه الأوامر المنسقة بشكل خاص والمستخدمة لتمييز الأحرف للعرض ولا يمكن أن تزيد عن 32 حرفًا. يتم تعريف كلمة التحكم من خلال:

\<ASCII Letter Sequence> //<//Delimiter//> //

كل كلمة تحكم حساسة لحالة الأحرف وتبدأ بشرطة مائلة للخلف. يمكن أن يحتوي تسلسل حروف ASCII على أبجديات ASCII (من الألف إلى الياء ومن الألف إلى الياء). ال<Delimite> يشير إلى نهاية اسم كلمة التحكم ويمكن أن يكون واحدًا مما يلي:

* مساحة. يعمل هذا فقط على تحديد كلمة تحكم ويتم تجاهله في المعالجة اللاحقة.
* رقم رقمي أو علامة ناقص ASCII ، مما يشير إلى أن معلمة رقمية مرتبطة بكلمة التحكم. يتم بعد ذلك تحديد التسلسل الرقمي التالي بأي حرف بخلاف رقم ASCII (عادةً ما تكون كلمة تحكم أخرى تبدأ بشرطة مائلة للخلف). يمكن أن تكون المعلمة رقمًا عشريًا موجبًا أو سالبًا. نطاق القيم للرقم هو اسميًا –32768 حتى 32767 ، أي عدد صحيح 16 بتة موقّع. يأخذ عدد صغير من كلمات التحكم قيمًا في النطاق −2،147،483،648 إلى 2،147،483،647 (عدد صحيح موقعة 32 بت). تتضمن كلمات التحكم هذه ** \ binN ** ، ** \ revdttmN // ** ، ** \ rsidN ** كلمات التحكم ذات الصلة وبعض خصائص الصورة مثل ** \ bliptagN **. هنا يرمز ** N ** إلى المعلمة الرقمية. يجب أن يسمح محلل RTF بما يصل إلى 10 أرقام بشكل اختياري مسبوقة بعلامة ناقص. إذا كان المحدد عبارة عن مسافة ، فسيتم إهماله ، أي أنه لا يتم تضمينه في المعالجة اللاحقة.
* أي حرف بخلاف الحرف أو الرقم. في هذه الحالة ، ينهي حرف التحديد كلمة التحكم وليس جزءًا من كلمة التحكم. مثل الشرطة المائلة للخلف "\" ، والتي تعني كلمة تحكم جديدة أو يتبع رمز تحكم.

#### رمز التحكم ####

يمثل رمز التحكم حدثًا خاصًا له معنى محدد اعتمادًا على محتوياته. يتكون من شرطة مائلة للخلف متبوعة بحرف خاص (حرف غير أبجدي) ولا يحتوي على أي محددات.

#### مجموعة ####

يمكن أن تتكون المجموعة من نص أو كلمات تحكم أو رموز تحكم محاطة بأقواس (** {} **). يشير قوس الافتتاح (** {**) إلى بداية المجموعة ويشير قوس الإغلاق (**} **) إلى نهاية المجموعة. تحدد كل مجموعة النص المتأثر بالمجموعة والسمات المختلفة لذلك النص.

### بنية ملف RTF ###

يحتوي ملف RTF على البنية القياسية التالية:

تم تقديمه وتوثيقه بواسطة Microsoft ، يمثل Rich Text Format (** RTF **) طريقة لترميز النص والرسومات المنسقة للاستخدام داخل التطبيقات. يسهل التنسيق تبادل المستندات عبر الأنظمة الأساسية مع منتجات Microsoft الأخرى ، وبالتالي يخدم غرض قابلية التشغيل البيني. هذه الإمكانية تجعلها معيارًا لنقل البيانات بين برامج معالجة الكلمات ، وبالتالي ، يمكن نقل المحتويات من نظام تشغيل إلى آخر دون فقدان تنسيق المستند. تتوفر مواصفات تنسيق الملف بواسطة Microsoft لـ [التنزيل] العام (https://interoperability.blob.core.windows.net/files/Archive_References/%5bMSFT-RTF%5d.pdf) ويمكن الرجوع إليها من منظور المطور.

#### رأس RTF ####

يحتوي رأس RTF على التمثيل التالي.

| الحقل | الوصف
---|---|
| \<header> | ** \ rtf1 \ fbidis **؟ \<character set> \<from> ؟ \<deffont> \<deflang> \<fonttbl> ؟ \<filetbl> ؟ \<colortbl> ؟ \<stylesheet> ؟ \<stylerestrictions> ؟ \<listtables> ؟ \<revtbl> ؟ \<rsidtable> ؟ \<mathprops> ؟ \<generator> ؟

يجب أن تظهر جداول الرأس بهذا الترتيب إذا كانت موجودة. يمكن أن يشتمل ملف RTF على مجموعات للخطوط والأنماط ولون الشاشة والصور والحواشي السفلية والتعليقات (التعليقات التوضيحية) والرؤوس والتذييلات والمعلومات الموجزة والحقول والإشارات المرجعية والمستند وخصائص تنسيق الفقرة والفقرة والحروف والرياضيات ، الصور والأشياء. إذا تم تضمين الخط والملف والنمط واللون وعلامة المراجعة ومجموعات المعلومات الموجزة وخصائص تنسيق المستند في الملف ، فيجب أن تظهر في رأس RTF ، الذي يسبق نص RTF. إذا لم يتم استخدام محتوى أي مجموعة ، يمكن حذف المجموعة. يجب أن تظهر أي مجموعة تستخدم الخصائص المحددة في مجموعة أخرى بعد المجموعة التي تحدد تلك الخصائص. على سبيل المثال ، يجب أن تسبق خصائص اللون والخط مجموعة الأنماط.

#### إصدار RTF ####

يجب أن يبدأ مستند RTF بهذه الأحرف الستة:

```
{\rtf1
```
حيث 1 يظهر رقم إصدار RTF.

#### مجموعة الأحرف ####

بعد {\ rtf1 ، يجب أن يعلن المستند عن مجموعة الأحرف التي يستخدمها. طريقة إعلان مجموعة الأحرف هي باستخدام أحد هذه الأوامر:

"\ ansi" - المستند موجود في مجموعة أحرف ANSI ، والمعروفة أيضًا باسم Code Page 1252 ، وهي مجموعة أحرف MSWindows المعتادة.

"\ mac" - المستند موجود في مجموعة أحرف MacAscii ، وهي مجموعة الأحرف المعتادة ضمن الإصدارات القديمة (ما قبل 10) من نظام التشغيل Mac OS.

"\ pc" - المستند موجود في DOS Code Page 437 ، مجموعة الأحرف الافتراضية لـ MS-DOS. سيلاحظ الكاتبون الذين يتمتعون بذاكرة عضلية جيدة أن هذه هي مجموعة الأحرف التي لا تزال تُستخدم لتفسير الرموز "الرقمية البديلة" - على سبيل المثال ، عندما تضغط باستمرار على Alt وتكتب "130" على لوحة المفاتيح الرقمية ، فإنها تنتج حرف é ، لأن الحرف 130 في CP437 هو é. هذا هو الاستخدام الوحيد الذي يراه CP437 هذه الأيام.

"\ pca" - المستند موجود في DOS Code Page 850 ، والمعروف أيضًا باسم MS-DOS Multilingual Code Page.

#### أمر الخط ####

تعريف مجموعة الأحرف متبوع بالأمر `\ deffN`. هذا يحدد أن رقم الخط N هو الخط الافتراضي لهذا المستند. يشار إلى رقم الخط N من جدول الخطوط. الأمر `\ deffN` اختياري تقنيًا ، ولكن يجب أن يكون موجودًا ليكون في الجانب الآمن كمقدمة عامة مثل اختيار الخط 0 كخط افتراضي.

"{\ rtf1 \ ansi \ deff0"

#### جدول الخطوط ####

يتم سرد جميع الخطوط التي يمكن استخدامها في المستند في جدول الخطوط حيث يتم تمثيل كل خط برقم خط. يجب أن يحتوي المستند على جدول خطوط على الرغم من أن بعض البرامج ستعمل بدون ذلك أيضًا.

بناء الجملة لجدول الخطوط هو {\ fonttbl // ...

`{\ fnumber \ familycommand Fontname ؛}`

جدول الخطوط الذي يحتوي على أربعة إقرارات هو كما يلي:

```
{\fonttbl
{\f0\froman Times;}
{\f1\fswiss Arial;}
{\f2\fmodern Courier New;}
}
```

في مستند يحتوي على جدول الخطوط هذا ، سيطبع "{\ f2 stuff}" "stuff" في Courier New. لا يمكن استخدام الخط في مستند حتى يتم إدراجه في جدول الخطوط.

### نهاية الوثيقة ###

يجب أن ينتهي كل مستند RTF بـ} ، لإغلاق المجموعة المفتوحة بواسطة {هذا هو الحرف الأول في المستند. لا شيء يمكن أن يتبع النهائي} ، باستثناء ربما سطر جديد.

## مراجع ##

* [مواصفات RTF 1.9.1](https://interoperability.blob.core.windows.net/files/Archive_References/%5bMSFT-RTF%5d.pdf)
* [Rich Text Format](https://en.wikipedia.org/wiki/Rich_Text_Format)

