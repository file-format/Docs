{
  "date" : "2020-11-11",
  "keywords" :["NDF" , "امتداد" , "ملف" , "تنسيق الملف" , "نوع ملف قاعدة البيانات" , "تنسيق ملف قاعدة البيانات" , "ملفات قاعدة البيانات"] ,
  "author" : {
    "display_name" : "Kashif Iqbal"
} ,
  "draft" : "false",
  "toc" : true,
  "description" :"تعرف على تنسيق ملف MDF وواجهات برمجة التطبيقات التي يمكنها إنشاء ملفات NDF وفتحها." ,
  "title" :"تنسيق ملف NDF - ملف قاعدة بيانات SQL Server الرئيسية" ,
  "linktitle" : "NDF",
  "menu" : {
    "docs" : {
      "parent" : "database"
}
} ,
  "lastmod" : "2020-08-12"
}

## ما هو ملف NDF؟

الملف بامتداد .ndf هو ملف قاعدة بيانات ثانوي يستخدمه [Microsoft SQL Server](https://en.wikipedia.org/wiki/Microsoft_SQL_Server) لتخزين بيانات المستخدم. NDF هو ملف تخزين ثانوي لأن خادم SQL يخزن البيانات المحددة للمستخدم في ملف التخزين الأساسي المعروف باسم [MDF](/ar/database/mdf/). يعد ملف بيانات NDF اختياريًا ويتم تحديده من قبل المستخدم لإدارة تخزين البيانات في حالة استخدام ملف MDF الأساسي لكل المساحة المخصصة. عادة ما يتم تخزينه على قرص منفصل ويمكن أن ينتشر إلى أجهزة تخزين متعددة. يعد وجود ملفات MDF ضروريًا لفتح ملفات NDF.

## تنسيق ملف NDF

لا يختلف تنسيق ملف NDF عن [MDF](/ar/database/mdf/) ويستخدم الصفحات كوحدة أساسية لتخزين البيانات. تبدأ كل صفحة برأس 96 بايت يتضمن:

* معرف الصفحة
* نوع الهيكل
* عدد السجلات في الصفحات
* مؤشرات للصفحات السابقة والتالية

### بنية ملف NDF

يحتوي ملف MDF على بنية البيانات التالية.

* الصفحة 0: الرأس
* الصفحة 1: أول PFS
* الصفحة 2: أول GAM
* الصفحة 3: أول SGAM
* الصفحة 4: غير مستخدمة
* الصفحة 5: غير مستخدمة
* الصفحة 6: أول DCM
* الصفحة 7: أول مليار متر مكعب

#### رأس ملف NDF

يحتوي رقم الصفحة 0 لجميع الملفات على رأس يخزن البيانات الأولية حول الملف.

#### المساحة الحرة للصفحة (PFS)
يحدد PFS حالة التخصيص ويحدد مقدار المساحة الخالية.

* البت 1: يشير إلى ما إذا كانت الصفحة مخصصة أم لا.
* البت 2: يشير إلى ما إذا كانت الصفحة من مدى مختلط.
* البت 3: يشير إلى أن هذه الصفحة هي صفحة IAM.
* البت 4: يشير إلى أن هذه الصفحة تحتوي على سجلات شبح
* البتات من 5 إلى 7: قيمة مجمعة مكونة من ثلاث بتات ، والتي تشير إلى امتلاء الصفحة كما يلي:
* 0: الصفحة فارغة
* 1: الصفحة ممتلئة بنسبة 1–50٪
* 2: الصفحة ممتلئة بنسبة 51-80٪
* 3: الصفحة ممتلئة بنسبة 81-95٪
* 4: الصفحة ممتلئة بنسبة 96-100٪

## صفحة ملف البيانات

تبدأ الصفحات في ملف بيانات SQL Server من الصفر (0) وتتزايد بالتتابع. يتم التعرف على كل ملف بواسطة رقم معرف ملف فريد. يقوم زوج معرف الملف ورقم الصفحة بتعريف صفحة في قاعدة بيانات بشكل فريد. مثال يظهر أرقام الصفحات في قاعدة بيانات ، كما في الصورة التالية.

{{< figure src="../ndf.png" alt="تنسيق ملف قاعدة بيانات NDF" >}}

يعرض هذا المثال أرقام الصفحات في قاعدة بيانات بها ملف بيانات أساسي بحجم 4 ميغا بايت وملف بيانات ثانوي بحجم 1 ميغا بايت.

## مراجع

* [ملفات قاعدة البيانات ومجموعات الملفات](https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-files-and-filegroups?view=sql-server-ver16)
* [فصل وإرفاق قاعدة البيانات - SQL Server](https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-detach-and-attach-sql-server?view=sql-server-ver15)
* [تحليل تشريح ملف بيانات خادم SQL](https://blog.pythian.com/analyzing-sql-server-data-file-anatomy/)

