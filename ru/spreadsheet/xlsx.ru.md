{
  "date" : "2019-12-10",
  "keywords" :[ "XLSX", "файл", "расширение", "формат файла", "Excel", "электронная таблица" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Узнайте, что такое файл XLSX и API, которые могут создавать и открывать файлы XLSX.",
  "title" :"Формат файла XLSX — что такое файл XLSX?",
  "linktitle" : "XLSX",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## .XLSX вариант №

**XLSX** — широко известный формат документов Microsoft Excel, который был представлен корпорацией Майкрософт в выпуске Microsoft Office 2007. Основан на структуре, организованной в соответствии с соглашениями об открытой упаковке, как описано в [Часть 2](https://www. .ecma-international.org/publications/standards/Ecma-376.htm) стандарта OOXML ECMA-376, новый формат представляет собой zip-пакет, содержащий ряд XML-файлов. Базовую структуру и файлы можно изучить, просто разархивировав файл .xlsx.

## Краткая история формата файла XLSX

Формат файла XLSX был представлен в 2007 году и использует стандарт Open XML, адаптированный Microsoft еще в 2000 году. До XLSX использовался общий формат файла [XLS](/ru/spreadsheet/xls/), который был чисто двоичным форматом файла. В новом типе файлов добавлены преимущества небольших размеров файлов, меньших изменений в повреждении и хорошо отформатированного представления изображений. Это было в начале 2000 года, когда Microsoft решила внести изменения, чтобы приспособить стандарт для **Office Open XML**. К 2007 году этот новый формат файлов стал частью Office 2007 и поддерживается также в новых версиях Microsoft Office.

## Спецификации формата файла XLSX

Официальные [спецификации формата файла XLSX](https://learn.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/2c5dee00-eff2-4b22-92b6-0738acd4475e) доступны в Интернете на сайте Microsoft. Чтобы увидеть, что находится внутри файла XLSX, просто переименуйте его в файл [ZIP](/ru/compression/zip/), изменив его расширение, а затем извлеките его, чтобы просмотреть файлы, составляющие эту книгу Excel. Пустая книга при извлечении в файлы содержит следующие составляющие файлы и папки.

### [Типы содержимого].xml ###

Это единственный файл, который находится на базовом уровне при распаковке zip-архива. В нем перечислены типы содержимого для частей внутри пакета. Все ссылки на XML-файлы, включенные в пакет, указаны в этом XML-файле.

### \_rels (папка) ###

Это папка «Отношения», которая содержит один XML-файл, в котором хранятся отношения на уровне пакетов. Ссылки на ключевые части файлов Xlsx содержатся в этом файле в виде URI. Эти URI определяют тип отношения каждой ключевой части к пакету. Это включает отношение к основному офисному документу, расположенному как xl/workbook.xml, и другим частям в docProps в качестве основных и расширенных свойств.

### docProps ###

Эта папка содержит общие свойства документа. К ним относятся набор основных свойств, набор расширенных или специфичных для приложения свойств и предварительный просмотр документа в виде эскиза. Пустая книга содержит два файла в этой папке, а именно app.xml и core.xml. Файл core.xml содержит такую информацию, как автор, дата создания и сохранения, а также изменения. App.xml содержит информацию о содержимом файла.

### xl (папка) ###

Это основная папка, содержащая все сведения о содержимом рабочей книги. По умолчанию он имеет следующие папки:

* \_rels
* тема
* рабочие листы

и следующие xml-файлы:

* стили.xml
* рабочая книга.xml

## Пример формата XLSX ##


Для каждого рабочего листа Excel, содержащегося в рабочей книге, существует один XML-файл. Вы можете найти эти файлы XML в папке xl/worksheets. Вся информация, содержащаяся на рабочем листе, организована в различных разделах XML-файла. Давайте рассмотрим образец рабочего листа из рабочей книги, который показан на следующем рисунке.

{{< figure src="../XLSX file format.png" alt="Формат файла XLSX" >}}

Как видно, этот рабочий лист содержит содержимое ячеек с A1 по B2 и изображение. Кроме того, ячейка G13 в настоящее время является активной ячейкой на листе. Теперь давайте изучим файл xl/worksheets/sheet1.xml, чтобы увидеть, как эта информация представлена в XML-файле. Содержимое этого XML-файла показано ниже.

{{< figure src="../XLSX File Format Details.png" alt="Формат файла XPS" >}}

1. К вкладке применен цвет темы. Он упоминается в файле XML с тегом<tabColor> после идентификатора темы.
1. Значение tabSelected установлено на 1, что показывает, что это выбранный лист
1. Как видно на первом изображении выше, ячейка G13 на листе является активной ячейкой, которая также упоминается в файле XML.
1. Вкладка SheetData представляет данные, содержащиеся на рабочем листе. Однако вы можете видеть, что исходного содержимого рабочего листа нет нигде в этом разделе. Это связано с тем, что текст косвенно упоминается из XML-листа "sharedStrings". Такое связывание гарантирует, что каждый текст сохраняется только один раз, и на него можно ссылаться снова для экономии места.
1. На изображение, как видно, ссылается идентификатор ссылки «rId2».

## Делать вклад

Хотите поделиться чем-то о форматах файлов XLSX или электронных таблиц? Вы можете опубликовать свои выводы в разделе [Новости формата электронных таблиц](https://news.fileformat.com/t/Spreadsheet).

## использованная литература

* [[MS-XLSX] — формат файла XLSX](https://learn.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/2c5dee00-eff2-4b22-92b6-0738acd4475e)
* [Open Office XML](http://officeopenxml.com/anatomyofOOXML-xlsx.php)

