{
  "date" : "2019-12-10",
  "keywords" :[ "XLM", "файл", "расширение", "формат файла", "файл макроса Microsoft Excel", "электронная таблица" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"Ваше руководство по формату файла, чтобы узнать, что такое файл XLM Macros и API, которые могут создавать и открывать файлы XLM.",
  "title" :"Что такое файл XLM?",
  "linktitle" : "XLM",
  "menu" : {
    "docs" : {
      "parent" : "spreadsheet"
}
},
  "lastmod" : "2019-12-10"
}

## .XLM вариант №

XLM для Excel Macro — это тип файлов электронных таблиц, которые используются для хранения макросов. С точки зрения приложения макрос — это набор инструкций, которые используются для автоматизации процессов. Макрос используется для записи повторяющихся шагов для файла формата [XLS](/ru/spreadsheet/xls/) и облегчает выполнение действий путем повторного запуска макроса. Макросы программируются с помощью Microsoft Visual Basic для приложений (VBA) из рабочей книги Excel с помощью редактора Visual Basic, и их можно запускать/отлаживать непосредственно из него.

## Краткая история ##

Microsoft Excel поддерживал программирование макросов с момента своего первого публичного запуска. Функции макросов остались прежними в последующих версиях Excel с расширением в соответствии с новыми функциями. XLM был языком макросов по умолчанию для Excel до Excel 4.0. Excel 5.0 записывает макросы в VBA по умолчанию, но в версии 5.0 запись XLM по-прежнему разрешена в качестве опции. После версии 5.0 эта опция была прекращена. Все версии Excel, включая Excel 2010, могут запускать макросы XLM, хотя Microsoft не рекомендует их использовать.

## Запись макроса в XLM ##

Excel предоставляет простые в использовании шаги для записи макроса. Для работы с макросами требуется, чтобы у вас были установлены инструменты разработчика. Когда запись макроса находится в процессе, она записывает каждое действие пользователя, которое будет воспроизведено позже. Запись макроса фактически включает в себя все шаги, которые пользователь выполняет после начала записи. Таким образом, если выделить содержимое ячейки полужирным шрифтом, курсивом и установить ее выравнивание по ширине после начала записи макроса, все эти команды будут записаны. Каждому записанному макросу также можно назначить ярлык для быстрого воспроизведения в дальнейшем. Запись макроса генерирует код VBA в виде макроса, который можно редактировать с помощью редактора Visual Basic (VBE).

## Объектная модель Excel ##

Макросы используют подпрограммы VBA и следуют [объектной модели Excel] (https://docs.microsoft.com/en-us/office/vba/api/overview/excel/object-model) для этой цели. Эта модель идентифицирует объекты электронной таблицы для взаимодействия с электронной таблицей через определяемые пользователем командные панели инструментов, панели команд или окна сообщений. Например, доступ к свойствам рабочей книги предоставляется с помощью объекта Workbook. Точно так же в модели есть объект Worksheet для программной работы с рабочими листами рабочей книги.

## Макросы и безопасность ##

VBA позволяет получить доступ ко всем областям приложения, а также к файловой системе и также может быть опасным. Это вызывает опасения при совместном использовании книги с кем-то, кто может запустить файл на своем конце. То есть Microsoft Excel предупреждает об открытии такого файла. Макросы могут быть сертифицированы цифровой подписью, чтобы другие пользователи могли убедиться, что они заслуживают доверия. Таким образом, макросы могут быть включены после проверки их источника.

## Использованная литература ##

* [[MS-XLS] — структура формата двоичных файлов Excel] (https://msdn.microsoft.com/en-us/library/cc313154(v#office.12).aspx)
* [Макропрограммирование](https://en.wikipedia.org/wiki/Microsoft_Excel#Macro_programming)

