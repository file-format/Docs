{
  "date" : "2019-10-11",
  "keywords" :[ "ascx","ไฟล์ ascx", "รูปแบบไฟล์ ascx", "ประเภทไฟล์ ascx", "ไฟล์", "ประเภท", "ไฟล์ ascx คืออะไร" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"รูปแบบไฟล์ ASCX",
  "description" :"เรียนรู้เกี่ยวกับไฟล์ ASCX และ API ที่สามารถสร้างและเปิดไฟล์ ASCX ได้",
  "linktitle" : "ASCX",
  "menu" : {
    "docs" : {
      "parent" : "web"
}
},
  "lastmod" : "2020-09-10"
}

## ไฟล์ ASCX คืออะไร??

ไฟล์ที่มีนามสกุล .ascx คือส่วนควบคุมของผู้ใช้ที่ใช้เป็นส่วนประกอบที่ใช้ซ้ำได้ในเว็บเพจ มีการอ้างอิงในเว็บไซต์ ASP ใดๆ โดยลากจากกล่องควบคุมไปยังเพจ การควบคุมผู้ใช้ ASCX ถูกเพิ่มในโครงการเป็นแหล่งกลาง ส่งผลให้การเปลี่ยนแปลงใดๆ ในการควบคุมผู้ใช้มีผลทั่วทั้งเว็บไซต์ ซึ่งแตกต่างจากไฟล์ ASMX ซึ่งกำหนดกลไกในการสื่อสารภายใน 2 อ็อบเจ็กต์บนอินเทอร์เน็ต ไฟล์ ASCX คือการควบคุมของผู้ใช้สำหรับการฝังในเพจหรือเว็บไซต์

## รูปแบบไฟล์ ASCX

ไฟล์ ASCX เขียนในรูปแบบข้อความล้วน และสามารถใช้โค้ดที่อยู่เบื้องหลังคุณสมบัติต่างๆ เช่น หน้าเว็บที่ลงท้ายด้วย .ascx.cs รหัสมาร์กอัปของการควบคุมผู้ใช้เริ่มต้นด้วยคำสั่ง @Control ตามที่แสดงในตัวอย่างต่อไปนี้

```
<%@ Control Language="VB" AutoEventWireup="false" CodeFile="WebUserControl.ascx.vb" Inherits="WebUserControl" %>
<p>A simple web user control with static HTML only.</p>
```

การควบคุมผู้ใช้เว็บนี้สามารถนำมาใช้ซ้ำได้ในหลายหน้า เช่น ส่วนท้ายของหน้า ส่วนหัว หรือการนำทางของไซต์บางประเภท การควบคุมผู้ใช้เว็บมีคุณสมบัติ วิธีการ และเหตุการณ์เหมือนกับคอนโทรลอื่น ๆ ซึ่งทำให้มีประโยชน์ในการตั้งค่าพฤติกรรมการมองเห็น

### ตัวอย่างการลงทะเบียนการควบคุมผู้ใช้ใน web.config

หากต้องการใช้การควบคุมของผู้ใช้คนเดียวในหลายหน้า การควบคุมเว็บสามารถลงทะเบียนใน web.config สิ่งนี้ทำให้สามารถใช้การควบคุมเว็บไซต์ทั้งหมดแทนการลงทะเบียนในแต่ละหน้าทีละรายการ โค้ดตัวอย่างต่อไปนี้กำหนดวิธีการลงทะเบียนการควบคุมเว็บใน web.config ที่จะแสดงเป็นส่วนท้ายบนเว็บไซต์ทั้งหมด

```
<configuration>
  <system.web>
    <pages>
      <controls>
        <add src="Footer.ascx" tagPrefix="bs" tagName="footer" />
      </controls >
    </pages >
  </system.web>
</configuration>
```
## อ้างอิง

* [ASCX กับ ASMX](https://social.msdn.microsoft.com/Forums/en-US/a27d4c2f-b972-439e-a7fe-f4b7e3637700/how-to-work-with-ascx-files?forum=aspwebforms)
* [การควบคุมผู้ใช้ ASCX](https://beansoftware.com/ASP.NET-Tutorials/User-Control.aspx)

