{
  "date" : "2020-11-11",
  "keywords" :[ "LDF", "นามสกุล", "ไฟล์", "รูปแบบไฟล์", "ประเภทไฟล์ฐานข้อมูล", "รูปแบบไฟล์ฐานข้อมูล", "ไฟล์ฐานข้อมูล" ],
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "description" :"เรียนรู้เกี่ยวกับรูปแบบไฟล์ LDF และ API ที่สามารถสร้างและเปิดไฟล์ LDF",
  "title" :"LDF - รูปแบบไฟล์ฐานข้อมูลหลักของเซิร์ฟเวอร์ SQL",
  "linktitle" : "LDF",
  "menu" : {
    "docs" : {
      "parent" : "database"
}
},
  "lastmod" : "2020-08-12"
}

## ไฟล์ LDF คืออะไร??

ไฟล์ที่มีนามสกุล .ldf เป็นไฟล์บันทึกที่ดูแลโดย Microsoft SQL Server ซึ่งเป็นระบบจัดการฐานข้อมูลเชิงสัมพันธ์ (RDBMS) ธุรกรรมทั้งหมดที่ดำเนินการบนไฟล์ฐานข้อมูลหลัก ([MDF](/th/database/mdf/))(เช่น การแทรก การอัปเดต การลบ) จะถูกบันทึกในไฟล์ LDF ไฟล์ LDF เป็นส่วนประกอบที่สำคัญของฐานข้อมูลใดๆ ในกรณีที่ระบบล้มเหลว ไฟล์บันทึกจะถูกใช้เพื่อคืนค่าฐานข้อมูลให้อยู่ในสถานะที่สอดคล้องกัน ไฟล์บันทึกธุรกรรมสามารถเพิ่มขนาดได้หากธุรกรรมไม่ถูกคอมมิตทั้งหมด ไฟล์ LDF สามารถเปิดได้ด้วยแอปพลิเคชันซอฟต์แวร์ Microsoft SQL Server

## การดำเนินงานที่บันทึกในไฟล์ LDF

ไฟล์บันทึก SQL บันทึกการดำเนินการต่อไปนี้:

* จุดเริ่มต้นและจุดสิ้นสุดของแต่ละธุรกรรม

* การแก้ไขข้อมูลแต่ละครั้ง (แทรก อัปเดต หรือลบ) ซึ่งรวมถึงการเปลี่ยนแปลงโดยขั้นตอนการจัดเก็บของระบบหรือคำสั่ง data definition language (DDL) ไปยังตารางใดๆ รวมถึงตารางระบบ

* ทุกขอบเขตและการจัดสรรเพจหรือการจัดสรรคืน

* การสร้างหรือวางตารางหรือดัชนี

## รูปแบบไฟล์ LDF

ไฟล์ LDF ประกอบด้วยบันทึกธุรกรรม SQL Server ที่จัดเรียงเป็นสตริงบันทึกบันทึก บันทึกแต่ละบันทึกมีหมายเลขลำดับบันทึก (LSN) ที่สูงกว่า LSN ของบันทึกก่อนหน้า สตริงจะเชื่อมต่อกันในไฟล์ เนื่องจากคอมพิวเตอร์ความเร็วสูงในปัจจุบัน สามารถแทรกบันทึกในตำแหน่งที่มี LSN2 อยู่ในล็อกไฟล์ก่อน LSN1 เนื่องจากการดำเนินการถูกบันทึกเป็นอนุกรม การเปลี่ยนแปลงที่อธิบายโดย LSN2 จึงถูกดำเนินการหลังจากบันทึกบันทึก LSN1 บันทึกสำหรับธุรกรรมเฉพาะจะเชื่อมโยงย้อนหลังโดยใช้พอยน์เตอร์ที่ใช้และเร่งการย้อนกลับของธุรกรรม
 

## อ้างอิง

* [ไฟล์ฐานข้อมูลและกลุ่มไฟล์](https://learn.microsoft.com/en-us/sql/relational-databases/databases/database-files-and-filegroups?view=sql-server-ver15)
* [สถาปัตยกรรมบันทึกการทำธุรกรรมและคู่มือการจัดการ](https://learn.microsoft.com/en-us/sql/relational-databases/sql-server-transaction-log-architecture-and-management-guide?view=sql-server-ver15)

