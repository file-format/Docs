{
  "date" : "2019-10-11",
  "author" : {
    "display_name" : "Kashif Iqbal"
},
  "draft" : "false",
  "toc" : true,
  "title" :"รูปแบบไฟล์ WMV",
  "description":"เรียนรู้เกี่ยวกับรูปแบบไฟล์ WMV และ API ที่สามารถสร้างและเปิดไฟล์ WMV",
  "linktitle" : "WMV",
  "menu" : {
    "docs" : {
      "parent" : "video"
}
},
  "lastmod" : "2019-09-16"
}

## ไฟล์ WMV คืออะไร??

รูปแบบระบบขั้นสูง (ASF) เป็นคอนเทนเนอร์มัลติมีเดียดิจิทัลที่ออกแบบมาเพื่อจัดเก็บและส่งสัญญาณสตรีมมีเดียเป็นหลัก Microsoft Windows Media Video (WMV) เป็นรูปแบบวิดีโอที่บีบอัด และ Microsoft Windows Media Audio (WMA) เป็นรูปแบบเสียงที่บีบอัดพร้อมกับข้อมูลเมตาเพิ่มเติมในคอนเทนเนอร์ ASF ที่พัฒนาโดย Microsoft เมื่อไฟล์ WMV หรือ WMA ได้รับการเข้ารหัสด้วยตัวแปลงสัญญาณ Windows Media Video และ Windows Media Audio แล้ว ไฟล์เหล่านั้นจะถูกแสดงด้วยนามสกุล .asf WMV บีบอัดไฟล์ขนาดใหญ่เพื่อให้ได้อัตราการส่งผ่านเครือข่ายที่ดีขึ้นในขณะที่รักษาคุณภาพของวิดีโอ WMV ได้รับการออกแบบมาโดยเฉพาะเพื่อให้ทำงานบนอุปกรณ์ Windows ทั้งหมด หลังจากการกำหนดมาตรฐานโดยสมาคมวิศวกรภาพยนตร์และโทรทัศน์ (SMPTE) ปัจจุบัน WMV ถือเป็นรูปแบบมาตรฐานเปิด

## ประวัติศาสตร์ ##

ด้วยความช่วยเหลือของตัวแปลงสัญญาณที่เป็นกรรมสิทธิ์ของ Microsoft รูปแบบวิดีโอที่ถูกบีบอัดใหม่ได้รับการพัฒนาในปี 1999 ซึ่งรู้จักกันในชื่อ WMV7 ซึ่งใช้ MPEG-4 ส่วนที่ 2 มีการปรับปรุงเพิ่มเติมในสองเวอร์ชันเพิ่มเติม ได้แก่ WMV8 และ 9 Microsoft ส่งเวอร์ชัน 9^^th^^ ของ WMV เป็น SMPTE สำหรับการกำหนดมาตรฐานในปี 2546 ซึ่งในที่สุดก็ได้มาตรฐานในปี 2549 ในชื่อ SMPTE 421M หรือที่เรียกว่า VC-1 แนวคิดเบื้องหลัง WMV คือการพัฒนารูปแบบสื่อที่ฮาร์ดแวร์และซอฟต์แวร์ที่ Microsoft รองรับทั้งหมด นอกจากนี้ จุดประสงค์หลักอีกประการหนึ่งคือการส่งสตรีมวิดีโอผ่านอินเทอร์เน็ตในสถานการณ์ที่เหมาะสมที่สุด หลังจากการกำหนดมาตรฐานจาก SMPTE แล้ว WMV ก็กลายเป็นรูปแบบวิดีโอสำหรับดิสก์ Blu-ray

## ข้อมูลจำเพาะรูปแบบไฟล์

### คอนเทนเนอร์

โดยทั่วไป WMV จะถูกบรรจุลงในคอนเทนเนอร์ ASF แต่นอกจากนี้ คอนเทนเนอร์ Matroska หรือ AVI ยังสามารถรองรับได้ด้วยนามสกุล .mkv และ .avi ตามลำดับ

### วินโดว์มีเดียวิดีโอ 9

แม้ว่าจะมีตัวแปลงสัญญาณเสียงและวิดีโอที่หลากหลายใน Windows Media Video 9 ซีรีส์สำหรับการเขียนและเล่นสื่อดิจิทัล แต่ตัวแปลงสัญญาณ WMV-9 เป็นตัวแปลงสัญญาณวิดีโอล่าสุดและดีที่สุด เนื่องจากสามารถบีบอัดได้อย่างเหมาะสมจากอัตราบิตที่ต่ำมาก เช่น 160 x 120 ที่ 10 Kbps ถึง 1920 x 1080 ที่ 4-8 Mbps สำหรับวิดีโอ HD ที่หลากหลาย

### โครงสร้างของ Codec

WMV-9 มีรูปแบบสีภายใน 8 บิต 4:2:0 เช่นเดียวกับมาตรฐานการบีบอัดวิดีโอยอดนิยมอื่นๆ MPEG-1 และ H.261 WMV-9 ใช้การชดเชยการเคลื่อนไหวแบบบล็อกและรูปแบบการแปลงเชิงพื้นที่ โดยทั่วไป เราสามารถพูดได้ว่ามาตรฐานเหล่านี้ทำการชดเชยการเคลื่อนไหวแบบบล็อกต่อบล็อกจากเฟรมที่สร้างใหม่ก่อนหน้านี้โดยใช้ปริมาณ 2 มิติที่เรียกว่าเวกเตอร์การเคลื่อนที่ (MV) เพื่อส่งสัญญาณการกระจัดเชิงพื้นที่ บล็อกปัจจุบันถูกสร้างขึ้นด้วยความช่วยเหลือของการทำนายค่าจากเฟรมที่สร้างใหม่ก่อนหน้าขนาดเดียวกันซึ่งถูกแทนที่จากตำแหน่งปัจจุบันโดยเวกเตอร์การเคลื่อนที่ ในที่สุด ข้อผิดพลาดที่เหลือจะถูกคำนวณเป็นความแตกต่างระหว่างบล็อกที่ทำนายการชดเชยการเคลื่อนไหวและบล็อกจริง ข้อผิดพลาดที่เหลือนี้ถูกแปลงโดยใช้การแปลงแบบกระชับพลังงานเชิงเส้น จากนั้นจึงกำหนดปริมาณและเข้ารหัสเอนโทรปี

ค่าสัมประสิทธิ์การแปลงเชิงปริมาณจะถูกถอดรหัสแบบเอนโทรปี ถอดแบบเชิงปริมาณ และแปลงแบบผกผันเพื่อสร้างค่าประมาณของข้อผิดพลาดที่เหลือในฝั่งตัวถอดรหัส ซึ่งจากนั้นจะเพิ่มไปยังการทำนายการชดเชยการเคลื่อนไหวเพื่อสร้างการสร้างใหม่ คำอธิบายระดับสูงของตัวแปลงสัญญาณจะแสดงในรูปต่อไปนี้

ส่วนที่เหลือจะกล่าวถึงการปรับปรุงใหม่ใน WMV-9 ซึ่งแตกต่างจากโซลูชันการเข้ารหัสวิดีโอที่เหลือ เช่น มาตรฐาน MPEG WMV-9 มีเฟรมภายใน (I) ทำนาย (P) และทำนายสองทิศทาง (B) เฟรมภายในคือเฟรมที่เข้ารหัสโดยอิสระและไม่มีการพึ่งพาเฟรมอื่น เฟรมที่คาดเดาคือเฟรมที่ขึ้นอยู่กับเฟรมหนึ่งในอดีต การถอดรหัสเฟรมที่คาดคะเนจะเกิดขึ้นได้ก็ต่อเมื่อเฟรมอ้างอิงทั้งหมดก่อนเฟรมปัจจุบันที่เริ่มจากเฟรมล่าสุด (I) ถูกถอดรหัสแล้วเท่านั้น เฟรม B คือเฟรมที่มีการอ้างอิงสองรายการ หนึ่งรายการในอดีตทางโลกและอีกรายการหนึ่งในอนาคตทางโลก เฟรม B จะถูกส่งตามหลังการอ้างอิง ซึ่งหมายความว่าเฟรม B จะถูกส่งตามคำสั่งเพื่อให้แน่ใจว่ามีการอ้างอิงในขณะถอดรหัส เฟรม B ใน WMV-9 จะไม่ใช้เป็นข้อมูลอ้างอิงสำหรับเฟรมที่ตามมา ซึ่งจะทำให้เฟรม B อยู่นอกลูปการถอดรหัส ทำให้สามารถใช้ทางลัดระหว่างการถอดรหัสของเฟรม B โดยไม่มีการเลื่อนหรือเกิดภาพซ้อนในระยะยาว คำจำกัดความข้างต้นของเฟรม I, P และ B ใช้สำหรับทั้งลำดับโปรเกรสซีฟและอินเทอร์เลซ

ประสิทธิภาพของตัวแปลงสัญญาณวิดีโอจะถูกเปรียบเทียบกับพล็อตอัตราการบิดเบือน (RD) เป็นเส้นโค้ง 2 มิติที่แสดงความผิดเพี้ยนที่เกิดจากการบีบอัดที่บิตเรตหนึ่งๆ

WMV-9 ได้แก้ไขปัญหานี้ด้วยการแนะนำเทคนิคต่างๆ ตามรายการด้านล่าง:

1. การแปลงขนาดบล็อกแบบปรับได้

2. ชุดการแปลงที่มีความแม่นยำ จำกัด

3. การชดเชยการเคลื่อนไหว

4. การหาปริมาณและการลดจำนวน

5. การเข้ารหัสเอนโทรปีขั้นสูง

6. การกรองแบบวนซ้ำ

7. การเข้ารหัสเฟรม B ขั้นสูง

8. การเข้ารหัสอินเตอร์เลซ

9. ทับซ้อนกันให้เรียบ

10. เครื่องมืออัตราต่ำ

11. การชดเชยสีซีดจาง

## อ้างอิง ##

* [https://bytescout.com/blog/2014/10/windows-media-video-format.html](https://bytescout.com/blog/2014/10/windows-media-video-format.html )
* [https://en.wikipedia.org/wiki/Windows_Media_Video](https://en.wikipedia.org/wiki/Windows_Media_Video)
* [http://citeseerx.ist.psu.edu/viewdoc/download?doi#10.1.1.101.488&rep#rep1&type#pdf](http://citeseerx.ist.psu.edu/viewdoc/download?doi#10.1 .1.101.488&rep#rep1&type#pdf)

